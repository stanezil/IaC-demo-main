[
 {
  "Target": "combine/configs/deployment.yaml",
  "Class": "config",
  "Type": "kubernetes",
  "Misconfigurations": [
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV001",
    "Title": "Process can elevate its own privileges",
    "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'securityContext.allowPrivilegeEscalation' to false",
    "Namespace": "appshield.kubernetes.KSV001",
    "Query": "data.appshield.kubernetes.KSV001.deny",
    "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv001",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv001"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV003",
    "Title": "Default capabilities not dropped",
    "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should add 'ALL' to 'securityContext.capabilities.drop'",
    "Namespace": "appshield.kubernetes.KSV003",
    "Query": "data.appshield.kubernetes.KSV003.deny",
    "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv003",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
     "https://avd.aquasec.com/appshield/ksv003"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV011",
    "Title": "CPU not limited",
    "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'resources.limits.cpu'",
    "Namespace": "appshield.kubernetes.KSV011",
    "Query": "data.appshield.kubernetes.KSV011.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv011",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv011"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV012",
    "Title": "Runs as root user",
    "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'securityContext.runAsNonRoot' to true",
    "Namespace": "appshield.kubernetes.KSV012",
    "Query": "data.appshield.kubernetes.KSV012.deny",
    "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv012",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv012"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV013",
    "Title": "Image tag ':latest' used",
    "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should specify an image tag",
    "Namespace": "appshield.kubernetes.KSV013",
    "Query": "data.appshield.kubernetes.KSV013.deny",
    "Resolution": "Use a specific container image tag that is not 'latest'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv013",
    "References": [
     "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
     "https://avd.aquasec.com/appshield/ksv013"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV014",
    "Title": "Root file system is not read-only",
    "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'securityContext.readOnlyRootFilesystem' to true",
    "Namespace": "appshield.kubernetes.KSV014",
    "Query": "data.appshield.kubernetes.KSV014.deny",
    "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv014",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
     "https://avd.aquasec.com/appshield/ksv014"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV015",
    "Title": "CPU requests not specified",
    "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'resources.requests.cpu'",
    "Namespace": "appshield.kubernetes.KSV015",
    "Query": "data.appshield.kubernetes.KSV015.deny",
    "Resolution": "Set 'containers[].resources.requests.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv015",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv015"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV016",
    "Title": "Memory requests not specified",
    "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'resources.requests.memory'",
    "Namespace": "appshield.kubernetes.KSV016",
    "Query": "data.appshield.kubernetes.KSV016.deny",
    "Resolution": "Set 'containers[].resources.requests.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv016",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv016"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV018",
    "Title": "Memory not limited",
    "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'resources.limits.memory'",
    "Namespace": "appshield.kubernetes.KSV018",
    "Query": "data.appshield.kubernetes.KSV018.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv018",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv018"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV020",
    "Title": "Runs with low user ID",
    "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'securityContext.runAsUser' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV020",
    "Query": "data.appshield.kubernetes.KSV020.deny",
    "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv020",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv020"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV021",
    "Title": "Runs with low group ID",
    "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'my-nginx' of Deployment 'my-nginx' should set 'securityContext.runAsGroup' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV021",
    "Query": "data.appshield.kubernetes.KSV021.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv021",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv021"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV002",
    "Title": "Default AppArmor profile not set",
    "Description": "A program inside the container can bypass AppArmor protection policies.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV002",
    "Query": "data.appshield.kubernetes.KSV002.deny",
    "Resolution": "Remove 'container.apparmor.security.beta.kubernetes.io' annotation or set it to 'runtime/default'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv002",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv002"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV005",
    "Title": "SYS_ADMIN capability added",
    "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV005",
    "Query": "data.appshield.kubernetes.KSV005.deny",
    "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv005",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
     "https://avd.aquasec.com/appshield/ksv005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV006",
    "Title": "hostPath volume mounted with docker.sock",
    "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV006",
    "Query": "data.appshield.kubernetes.KSV006.deny",
    "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv006",
    "References": [
     "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
     "https://avd.aquasec.com/appshield/ksv006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV008",
    "Title": "Access to host IPC namespace",
    "Description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV008",
    "Query": "data.appshield.kubernetes.KSV008.deny",
    "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv008",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV009",
    "Title": "Access to host network",
    "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV009",
    "Query": "data.appshield.kubernetes.KSV009.deny",
    "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv009",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV010",
    "Title": "Access to host PID",
    "Description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV010",
    "Query": "data.appshield.kubernetes.KSV010.deny",
    "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv010",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV017",
    "Title": "Privileged container",
    "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV017",
    "Query": "data.appshield.kubernetes.KSV017.deny",
    "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv017",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV022",
    "Title": "Non-default capabilities added",
    "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV022",
    "Query": "data.appshield.kubernetes.KSV022.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv022",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV023",
    "Title": "hostPath volumes mounted",
    "Description": "HostPath volumes must be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV023",
    "Query": "data.appshield.kubernetes.KSV023.deny",
    "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv023",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV024",
    "Title": "Access to host ports",
    "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV024",
    "Query": "data.appshield.kubernetes.KSV024.deny",
    "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv024",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV025",
    "Title": "SELinux custom options set",
    "Description": "Setting a custom SELinux user or role option should be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV025",
    "Query": "data.appshield.kubernetes.KSV025.deny",
    "Resolution": "Do not set 'spec.securityContext.seLinuxOptions', spec.containers[*].securityContext.seLinuxOptions and spec.initContainers[*].securityContext.seLinuxOptions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv025",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv025"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV026",
    "Title": "Unsafe sysctl options set",
    "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV026",
    "Query": "data.appshield.kubernetes.KSV026.deny",
    "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset, {\"kernel.shm_rmid_forced\", \"net.ipv4.ip_local_port_range\", \"net.ipv4.ping_group_range\", \"net.ipv4.tcp_syncookies\"}",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv026",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv026"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV027",
    "Title": "Non-default /proc masks set",
    "Description": "The default /proc masks are set up to reduce attack surface, and should be required.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV027",
    "Query": "data.appshield.kubernetes.KSV027.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.procMount and spec.initContainers[*].securityContext.procMount.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv027",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv027"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV028",
    "Title": "Non-ephemeral volume types used",
    "Description": "In addition to restricting HostPath volumes, usage of non-ephemeral volume types should be limited to those defined through PersistentVolumes.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV028",
    "Query": "data.appshield.kubernetes.KSV028.deny",
    "Resolution": "Do not Set 'spec.volumes[*]' to any of the disallowed volume types.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv028",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv028"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV029",
    "Title": "A root primary or supplementary GID set",
    "Description": "Containers should be forbidden from running with a root primary or supplementary GID.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV029",
    "Query": "data.appshield.kubernetes.KSV029.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv029",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv029"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV030",
    "Title": "Default Seccomp profile not set",
    "Description": "The RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV030",
    "Query": "data.appshield.kubernetes.KSV030.deny",
    "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv030",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv030"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV102",
    "Title": "Tiller Is Deployed",
    "Description": "Check if Helm Tiller component is deployed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV202",
    "Query": "data.appshield.kubernetes.KSV202.deny",
    "Resolution": "Migrate to Helm v3 which no longer has Tiller component",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv102",
    "References": [
     "https://avd.aquasec.com/appshield/ksv102"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "combine/configs/service.yaml",
  "Class": "config",
  "Type": "kubernetes",
  "Misconfigurations": [
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV001",
    "Title": "Process can elevate its own privileges",
    "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV001",
    "Query": "data.appshield.kubernetes.KSV001.deny",
    "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv001",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv001"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV002",
    "Title": "Default AppArmor profile not set",
    "Description": "A program inside the container can bypass AppArmor protection policies.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV002",
    "Query": "data.appshield.kubernetes.KSV002.deny",
    "Resolution": "Remove 'container.apparmor.security.beta.kubernetes.io' annotation or set it to 'runtime/default'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv002",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv002"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV003",
    "Title": "Default capabilities not dropped",
    "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV003",
    "Query": "data.appshield.kubernetes.KSV003.deny",
    "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv003",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
     "https://avd.aquasec.com/appshield/ksv003"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV005",
    "Title": "SYS_ADMIN capability added",
    "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV005",
    "Query": "data.appshield.kubernetes.KSV005.deny",
    "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv005",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
     "https://avd.aquasec.com/appshield/ksv005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV006",
    "Title": "hostPath volume mounted with docker.sock",
    "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV006",
    "Query": "data.appshield.kubernetes.KSV006.deny",
    "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv006",
    "References": [
     "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
     "https://avd.aquasec.com/appshield/ksv006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV008",
    "Title": "Access to host IPC namespace",
    "Description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV008",
    "Query": "data.appshield.kubernetes.KSV008.deny",
    "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv008",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV009",
    "Title": "Access to host network",
    "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV009",
    "Query": "data.appshield.kubernetes.KSV009.deny",
    "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv009",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV010",
    "Title": "Access to host PID",
    "Description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV010",
    "Query": "data.appshield.kubernetes.KSV010.deny",
    "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv010",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV011",
    "Title": "CPU not limited",
    "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV011",
    "Query": "data.appshield.kubernetes.KSV011.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv011",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv011"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV012",
    "Title": "Runs as root user",
    "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV012",
    "Query": "data.appshield.kubernetes.KSV012.deny",
    "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv012",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv012"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV013",
    "Title": "Image tag ':latest' used",
    "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV013",
    "Query": "data.appshield.kubernetes.KSV013.deny",
    "Resolution": "Use a specific container image tag that is not 'latest'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv013",
    "References": [
     "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
     "https://avd.aquasec.com/appshield/ksv013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV014",
    "Title": "Root file system is not read-only",
    "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV014",
    "Query": "data.appshield.kubernetes.KSV014.deny",
    "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv014",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
     "https://avd.aquasec.com/appshield/ksv014"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV015",
    "Title": "CPU requests not specified",
    "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV015",
    "Query": "data.appshield.kubernetes.KSV015.deny",
    "Resolution": "Set 'containers[].resources.requests.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv015",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv015"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV016",
    "Title": "Memory requests not specified",
    "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV016",
    "Query": "data.appshield.kubernetes.KSV016.deny",
    "Resolution": "Set 'containers[].resources.requests.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv016",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv016"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV017",
    "Title": "Privileged container",
    "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV017",
    "Query": "data.appshield.kubernetes.KSV017.deny",
    "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv017",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV018",
    "Title": "Memory not limited",
    "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV018",
    "Query": "data.appshield.kubernetes.KSV018.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv018",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv018"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV020",
    "Title": "Runs with low user ID",
    "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV020",
    "Query": "data.appshield.kubernetes.KSV020.deny",
    "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv020",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv020"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV021",
    "Title": "Runs with low group ID",
    "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV021",
    "Query": "data.appshield.kubernetes.KSV021.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv021",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv021"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV022",
    "Title": "Non-default capabilities added",
    "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV022",
    "Query": "data.appshield.kubernetes.KSV022.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv022",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV023",
    "Title": "hostPath volumes mounted",
    "Description": "HostPath volumes must be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV023",
    "Query": "data.appshield.kubernetes.KSV023.deny",
    "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv023",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV024",
    "Title": "Access to host ports",
    "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV024",
    "Query": "data.appshield.kubernetes.KSV024.deny",
    "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv024",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV025",
    "Title": "SELinux custom options set",
    "Description": "Setting a custom SELinux user or role option should be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV025",
    "Query": "data.appshield.kubernetes.KSV025.deny",
    "Resolution": "Do not set 'spec.securityContext.seLinuxOptions', spec.containers[*].securityContext.seLinuxOptions and spec.initContainers[*].securityContext.seLinuxOptions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv025",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv025"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV026",
    "Title": "Unsafe sysctl options set",
    "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV026",
    "Query": "data.appshield.kubernetes.KSV026.deny",
    "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset, {\"kernel.shm_rmid_forced\", \"net.ipv4.ip_local_port_range\", \"net.ipv4.ping_group_range\", \"net.ipv4.tcp_syncookies\"}",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv026",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv026"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV027",
    "Title": "Non-default /proc masks set",
    "Description": "The default /proc masks are set up to reduce attack surface, and should be required.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV027",
    "Query": "data.appshield.kubernetes.KSV027.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.procMount and spec.initContainers[*].securityContext.procMount.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv027",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv027"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV028",
    "Title": "Non-ephemeral volume types used",
    "Description": "In addition to restricting HostPath volumes, usage of non-ephemeral volume types should be limited to those defined through PersistentVolumes.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV028",
    "Query": "data.appshield.kubernetes.KSV028.deny",
    "Resolution": "Do not Set 'spec.volumes[*]' to any of the disallowed volume types.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv028",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv028"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV029",
    "Title": "A root primary or supplementary GID set",
    "Description": "Containers should be forbidden from running with a root primary or supplementary GID.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV029",
    "Query": "data.appshield.kubernetes.KSV029.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv029",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv029"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV030",
    "Title": "Default Seccomp profile not set",
    "Description": "The RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV030",
    "Query": "data.appshield.kubernetes.KSV030.deny",
    "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv030",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv030"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV102",
    "Title": "Tiller Is Deployed",
    "Description": "Check if Helm Tiller component is deployed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV202",
    "Query": "data.appshield.kubernetes.KSV202.deny",
    "Resolution": "Migrate to Helm v3 which no longer has Tiller component",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv102",
    "References": [
     "https://avd.aquasec.com/appshield/ksv102"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "custom-data/configs/Dockerfile",
  "Class": "config",
  "Type": "dockerfile",
  "Misconfigurations": [
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS002",
    "Title": "root user",
    "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
    "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
    "Namespace": "appshield.dockerfile.DS002",
    "Query": "data.appshield.dockerfile.DS002.deny",
    "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds002",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds002"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS001",
    "Title": "':latest' tag used",
    "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS001",
    "Query": "data.appshield.dockerfile.DS001.deny",
    "Resolution": "Add a tag to the image in the 'FROM' statement",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds001",
    "References": [
     "https://avd.aquasec.com/appshield/ds001"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS004",
    "Title": "Port 22 exposed",
    "Description": "Exposing port 22 might allow users to SSH into the container.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS004",
    "Query": "data.appshield.dockerfile.DS004.deny",
    "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds004",
    "References": [
     "https://avd.aquasec.com/appshield/ds004"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS005",
    "Title": "ADD instead of COPY",
    "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS005",
    "Query": "data.appshield.dockerfile.DS005.deny",
    "Resolution": "Use COPY instead of ADD",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds005",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#add",
     "https://avd.aquasec.com/appshield/ds005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS006",
    "Title": "COPY '--from' referring to the current image",
    "Description": "COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS006",
    "Query": "data.appshield.dockerfile.DS006.deny",
    "Resolution": "Change the '--form' so that it will not refer to itself",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds006",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS007",
    "Title": "Multiple ENTRYPOINT instructions listed",
    "Description": "There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS007",
    "Query": "data.appshield.dockerfile.DS007.deny",
    "Resolution": "Remove unnecessary ENTRYPOINT instruction.",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds007",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#entrypoint",
     "https://avd.aquasec.com/appshield/ds007"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS008",
    "Title": "Exposed port out of range",
    "Description": "UNIX ports outside the range 0-65535 are exposed.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS008",
    "Query": "data.appshield.dockerfile.DS008.deny",
    "Resolution": "Use port number within range",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds008",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#expose",
     "https://avd.aquasec.com/appshield/ds008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS009",
    "Title": "WORKDIR path not absolute",
    "Description": "For clarity and reliability, you should always use absolute paths for your WORKDIR.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS009",
    "Query": "data.appshield.dockerfile.DS009.deny",
    "Resolution": "Use absolute paths for your WORKDIR",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds009",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS010",
    "Title": "RUN using 'sudo'",
    "Description": "Avoid using 'RUN' with 'sudo' commands, as it can lead to unpredictable behavior.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS010",
    "Query": "data.appshield.dockerfile.DS010.deny",
    "Resolution": "Don't use sudo",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds010",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS011",
    "Title": "COPY with more than two arguments not ending with slash",
    "Description": "When a COPY command has more than two arguments, the last one should end with a slash.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS011",
    "Query": "data.appshield.dockerfile.DS011.deny",
    "Resolution": "Add slash to last COPY argument",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds011",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#copy",
     "https://avd.aquasec.com/appshield/ds011"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS012",
    "Title": "Duplicate aliases defined in different FROMs",
    "Description": "Different FROMs can't have the same alias defined.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS012",
    "Query": "data.appshield.dockerfile.DS012.deny",
    "Resolution": "Change aliases to make them different",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds012",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds012"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS013",
    "Title": "'RUN cd ...' to change directory",
    "Description": "Use WORKDIR instead of proliferating instructions like 'RUN cd … \u0026\u0026 do-something', which are hard to read, troubleshoot, and maintain.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS013",
    "Query": "data.appshield.dockerfile.DS013.deny",
    "Resolution": "Use WORKDIR to change directory",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds013",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS014",
    "Title": "RUN using 'wget' and 'curl'",
    "Description": "Avoid using both 'wget' and 'curl' since these tools have the same effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS014",
    "Query": "data.appshield.dockerfile.DS014.deny",
    "Resolution": "Pick one util, either 'wget' or 'curl'",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds014",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds014"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS015",
    "Title": "'yum clean all' missing",
    "Description": "You should use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS015",
    "Query": "data.appshield.dockerfile.DS015.deny",
    "Resolution": "Add 'yum clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds015",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds015"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS016",
    "Title": "Multiple CMD instructions listed",
    "Description": "There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS016",
    "Query": "data.appshield.dockerfile.DS016.deny",
    "Resolution": "Dockefile should only have one CMD instruction. Remove all the other CMD instructions",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds016",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#cmd",
     "https://avd.aquasec.com/appshield/ds016"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS017",
    "Title": "'RUN \u003cpackage-manager\u003e update' instruction alone",
    "Description": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS017",
    "Query": "data.appshield.dockerfile.DS017.deny",
    "Resolution": "Combine '\u003cpackage-manager\u003e update' and '\u003cpackage-manager\u003e install' instructions to single one",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds017",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS018",
    "Title": "'COPY --from' refers to alias not defined previously",
    "Description": "COPY commands with the flag '--from' should mention a previously defined FROM alias.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS018",
    "Query": "data.appshield.dockerfile.DS018.deny",
    "Resolution": "Specify an alias defined previously",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds018",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds018"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS019",
    "Title": "'dnf clean all' missing",
    "Description": "Cached package data should be cleaned after installation to reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS019",
    "Query": "data.appshield.dockerfile.DS019.deny",
    "Resolution": "Add 'dnf clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds019",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds019"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS020",
    "Title": "'zypper clean' missing",
    "Description": "The layer and image size should be reduced by deleting unneeded caches after running zypper.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS020",
    "Query": "data.appshield.dockerfile.DS020.deny",
    "Resolution": "Add 'zypper clean' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds020",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds020"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS021",
    "Title": "'apt-get' missing '-y' to avoid manual input",
    "Description": "'apt-get' calls should use the flag '-y' to avoid manual user input.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS021",
    "Query": "data.appshield.dockerfile.DS021.deny",
    "Resolution": "Add '-y' flag to 'apt-get'",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds021",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds021"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS022",
    "Title": "Deprecated MAINTAINER used",
    "Description": "MAINTAINER has been deprecated since Docker 1.13.0.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS022",
    "Query": "data.appshield.dockerfile.DS022.deny",
    "Resolution": "Use LABEL instead of MAINTAINER",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds022",
    "References": [
     "https://docs.docker.com/engine/deprecated/#maintainer-in-dockerfile",
     "https://avd.aquasec.com/appshield/ds022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS023",
    "Title": "Multiple HEALTHCHECK defined",
    "Description": "Providing more than one HEALTHCHECK instruction per stage is confusing and error-prone.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS023",
    "Query": "data.appshield.dockerfile.DS023.deny",
    "Resolution": "One HEALTHCHECK instruction must remain in Dockerfile. Remove all other instructions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds023",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#healthcheck",
     "https://avd.aquasec.com/appshield/ds023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS024",
    "Title": "'apt-get dist-upgrade' used",
    "Description": "'apt-get dist-upgrade' upgrades a major version so it doesn't make more sense in Dockerfile.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS024",
    "Query": "data.appshield.dockerfile.DS024.deny",
    "Resolution": "Just use different image",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds024",
    "References": [
     "https://avd.aquasec.com/appshield/ds024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "custom-policy/dockerfile/configs/Dockerfile",
  "Class": "config",
  "Type": "dockerfile",
  "Misconfigurations": [
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS002",
    "Title": "root user",
    "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
    "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
    "Namespace": "appshield.dockerfile.DS002",
    "Query": "data.appshield.dockerfile.DS002.deny",
    "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds002",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds002"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS001",
    "Title": "':latest' tag used",
    "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS001",
    "Query": "data.appshield.dockerfile.DS001.deny",
    "Resolution": "Add a tag to the image in the 'FROM' statement",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds001",
    "References": [
     "https://avd.aquasec.com/appshield/ds001"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS004",
    "Title": "Port 22 exposed",
    "Description": "Exposing port 22 might allow users to SSH into the container.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS004",
    "Query": "data.appshield.dockerfile.DS004.deny",
    "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds004",
    "References": [
     "https://avd.aquasec.com/appshield/ds004"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS005",
    "Title": "ADD instead of COPY",
    "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS005",
    "Query": "data.appshield.dockerfile.DS005.deny",
    "Resolution": "Use COPY instead of ADD",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds005",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#add",
     "https://avd.aquasec.com/appshield/ds005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS006",
    "Title": "COPY '--from' referring to the current image",
    "Description": "COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS006",
    "Query": "data.appshield.dockerfile.DS006.deny",
    "Resolution": "Change the '--form' so that it will not refer to itself",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds006",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS007",
    "Title": "Multiple ENTRYPOINT instructions listed",
    "Description": "There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS007",
    "Query": "data.appshield.dockerfile.DS007.deny",
    "Resolution": "Remove unnecessary ENTRYPOINT instruction.",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds007",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#entrypoint",
     "https://avd.aquasec.com/appshield/ds007"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS008",
    "Title": "Exposed port out of range",
    "Description": "UNIX ports outside the range 0-65535 are exposed.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS008",
    "Query": "data.appshield.dockerfile.DS008.deny",
    "Resolution": "Use port number within range",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds008",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#expose",
     "https://avd.aquasec.com/appshield/ds008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS009",
    "Title": "WORKDIR path not absolute",
    "Description": "For clarity and reliability, you should always use absolute paths for your WORKDIR.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS009",
    "Query": "data.appshield.dockerfile.DS009.deny",
    "Resolution": "Use absolute paths for your WORKDIR",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds009",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS010",
    "Title": "RUN using 'sudo'",
    "Description": "Avoid using 'RUN' with 'sudo' commands, as it can lead to unpredictable behavior.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS010",
    "Query": "data.appshield.dockerfile.DS010.deny",
    "Resolution": "Don't use sudo",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds010",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS011",
    "Title": "COPY with more than two arguments not ending with slash",
    "Description": "When a COPY command has more than two arguments, the last one should end with a slash.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS011",
    "Query": "data.appshield.dockerfile.DS011.deny",
    "Resolution": "Add slash to last COPY argument",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds011",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#copy",
     "https://avd.aquasec.com/appshield/ds011"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS012",
    "Title": "Duplicate aliases defined in different FROMs",
    "Description": "Different FROMs can't have the same alias defined.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS012",
    "Query": "data.appshield.dockerfile.DS012.deny",
    "Resolution": "Change aliases to make them different",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds012",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds012"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS013",
    "Title": "'RUN cd ...' to change directory",
    "Description": "Use WORKDIR instead of proliferating instructions like 'RUN cd … \u0026\u0026 do-something', which are hard to read, troubleshoot, and maintain.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS013",
    "Query": "data.appshield.dockerfile.DS013.deny",
    "Resolution": "Use WORKDIR to change directory",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds013",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS014",
    "Title": "RUN using 'wget' and 'curl'",
    "Description": "Avoid using both 'wget' and 'curl' since these tools have the same effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS014",
    "Query": "data.appshield.dockerfile.DS014.deny",
    "Resolution": "Pick one util, either 'wget' or 'curl'",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds014",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds014"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS015",
    "Title": "'yum clean all' missing",
    "Description": "You should use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS015",
    "Query": "data.appshield.dockerfile.DS015.deny",
    "Resolution": "Add 'yum clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds015",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds015"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS016",
    "Title": "Multiple CMD instructions listed",
    "Description": "There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS016",
    "Query": "data.appshield.dockerfile.DS016.deny",
    "Resolution": "Dockefile should only have one CMD instruction. Remove all the other CMD instructions",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds016",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#cmd",
     "https://avd.aquasec.com/appshield/ds016"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS017",
    "Title": "'RUN \u003cpackage-manager\u003e update' instruction alone",
    "Description": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS017",
    "Query": "data.appshield.dockerfile.DS017.deny",
    "Resolution": "Combine '\u003cpackage-manager\u003e update' and '\u003cpackage-manager\u003e install' instructions to single one",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds017",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS018",
    "Title": "'COPY --from' refers to alias not defined previously",
    "Description": "COPY commands with the flag '--from' should mention a previously defined FROM alias.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS018",
    "Query": "data.appshield.dockerfile.DS018.deny",
    "Resolution": "Specify an alias defined previously",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds018",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds018"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS019",
    "Title": "'dnf clean all' missing",
    "Description": "Cached package data should be cleaned after installation to reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS019",
    "Query": "data.appshield.dockerfile.DS019.deny",
    "Resolution": "Add 'dnf clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds019",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds019"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS020",
    "Title": "'zypper clean' missing",
    "Description": "The layer and image size should be reduced by deleting unneeded caches after running zypper.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS020",
    "Query": "data.appshield.dockerfile.DS020.deny",
    "Resolution": "Add 'zypper clean' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds020",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds020"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS021",
    "Title": "'apt-get' missing '-y' to avoid manual input",
    "Description": "'apt-get' calls should use the flag '-y' to avoid manual user input.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS021",
    "Query": "data.appshield.dockerfile.DS021.deny",
    "Resolution": "Add '-y' flag to 'apt-get'",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds021",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds021"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS022",
    "Title": "Deprecated MAINTAINER used",
    "Description": "MAINTAINER has been deprecated since Docker 1.13.0.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS022",
    "Query": "data.appshield.dockerfile.DS022.deny",
    "Resolution": "Use LABEL instead of MAINTAINER",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds022",
    "References": [
     "https://docs.docker.com/engine/deprecated/#maintainer-in-dockerfile",
     "https://avd.aquasec.com/appshield/ds022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS023",
    "Title": "Multiple HEALTHCHECK defined",
    "Description": "Providing more than one HEALTHCHECK instruction per stage is confusing and error-prone.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS023",
    "Query": "data.appshield.dockerfile.DS023.deny",
    "Resolution": "One HEALTHCHECK instruction must remain in Dockerfile. Remove all other instructions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds023",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#healthcheck",
     "https://avd.aquasec.com/appshield/ds023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS024",
    "Title": "'apt-get dist-upgrade' used",
    "Description": "'apt-get dist-upgrade' upgrades a major version so it doesn't make more sense in Dockerfile.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS024",
    "Query": "data.appshield.dockerfile.DS024.deny",
    "Resolution": "Just use different image",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds024",
    "References": [
     "https://avd.aquasec.com/appshield/ds024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "custom-policy/kubernetes/configs/deployment.yaml",
  "Class": "config",
  "Type": "kubernetes",
  "Misconfigurations": [
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV001",
    "Title": "Process can elevate its own privileges",
    "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.allowPrivilegeEscalation' to false",
    "Namespace": "appshield.kubernetes.KSV001",
    "Query": "data.appshield.kubernetes.KSV001.deny",
    "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv001",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv001"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV003",
    "Title": "Default capabilities not dropped",
    "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should add 'ALL' to 'securityContext.capabilities.drop'",
    "Namespace": "appshield.kubernetes.KSV003",
    "Query": "data.appshield.kubernetes.KSV003.deny",
    "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv003",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
     "https://avd.aquasec.com/appshield/ksv003"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV006",
    "Title": "hostPath volume mounted with docker.sock",
    "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
    "Message": "Deployment 'test-deny' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'",
    "Namespace": "appshield.kubernetes.KSV006",
    "Query": "data.appshield.kubernetes.KSV006.deny",
    "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv006",
    "References": [
     "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
     "https://avd.aquasec.com/appshield/ksv006"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV011",
    "Title": "CPU not limited",
    "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.limits.cpu'",
    "Namespace": "appshield.kubernetes.KSV011",
    "Query": "data.appshield.kubernetes.KSV011.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv011",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv011"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV012",
    "Title": "Runs as root user",
    "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsNonRoot' to true",
    "Namespace": "appshield.kubernetes.KSV012",
    "Query": "data.appshield.kubernetes.KSV012.deny",
    "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv012",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv012"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV014",
    "Title": "Root file system is not read-only",
    "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.readOnlyRootFilesystem' to true",
    "Namespace": "appshield.kubernetes.KSV014",
    "Query": "data.appshield.kubernetes.KSV014.deny",
    "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv014",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
     "https://avd.aquasec.com/appshield/ksv014"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV015",
    "Title": "CPU requests not specified",
    "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.requests.cpu'",
    "Namespace": "appshield.kubernetes.KSV015",
    "Query": "data.appshield.kubernetes.KSV015.deny",
    "Resolution": "Set 'containers[].resources.requests.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv015",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv015"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV016",
    "Title": "Memory requests not specified",
    "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.requests.memory'",
    "Namespace": "appshield.kubernetes.KSV016",
    "Query": "data.appshield.kubernetes.KSV016.deny",
    "Resolution": "Set 'containers[].resources.requests.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv016",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv016"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV018",
    "Title": "Memory not limited",
    "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.limits.memory'",
    "Namespace": "appshield.kubernetes.KSV018",
    "Query": "data.appshield.kubernetes.KSV018.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv018",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv018"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV020",
    "Title": "Runs with low user ID",
    "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsUser' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV020",
    "Query": "data.appshield.kubernetes.KSV020.deny",
    "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv020",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv020"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV021",
    "Title": "Runs with low group ID",
    "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsGroup' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV021",
    "Query": "data.appshield.kubernetes.KSV021.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv021",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv021"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV023",
    "Title": "hostPath volumes mounted",
    "Description": "HostPath volumes must be forbidden.",
    "Message": "Deployment 'test-deny' should not set 'spec.template.volumes.hostPath'",
    "Namespace": "appshield.kubernetes.KSV023",
    "Query": "data.appshield.kubernetes.KSV023.deny",
    "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv023",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv023"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV026",
    "Title": "Unsafe sysctl options set",
    "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.",
    "Message": "Deployment 'test-deny' should set 'securityContext.sysctl' to the allowed values",
    "Namespace": "appshield.kubernetes.KSV026",
    "Query": "data.appshield.kubernetes.KSV026.deny",
    "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset, {\"kernel.shm_rmid_forced\", \"net.ipv4.ip_local_port_range\", \"net.ipv4.ping_group_range\", \"net.ipv4.tcp_syncookies\"}",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv026",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv026"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV002",
    "Title": "Default AppArmor profile not set",
    "Description": "A program inside the container can bypass AppArmor protection policies.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV002",
    "Query": "data.appshield.kubernetes.KSV002.deny",
    "Resolution": "Remove 'container.apparmor.security.beta.kubernetes.io' annotation or set it to 'runtime/default'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv002",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv002"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV005",
    "Title": "SYS_ADMIN capability added",
    "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV005",
    "Query": "data.appshield.kubernetes.KSV005.deny",
    "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv005",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
     "https://avd.aquasec.com/appshield/ksv005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV008",
    "Title": "Access to host IPC namespace",
    "Description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV008",
    "Query": "data.appshield.kubernetes.KSV008.deny",
    "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv008",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV009",
    "Title": "Access to host network",
    "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV009",
    "Query": "data.appshield.kubernetes.KSV009.deny",
    "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv009",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV010",
    "Title": "Access to host PID",
    "Description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV010",
    "Query": "data.appshield.kubernetes.KSV010.deny",
    "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv010",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV013",
    "Title": "Image tag ':latest' used",
    "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV013",
    "Query": "data.appshield.kubernetes.KSV013.deny",
    "Resolution": "Use a specific container image tag that is not 'latest'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv013",
    "References": [
     "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
     "https://avd.aquasec.com/appshield/ksv013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV017",
    "Title": "Privileged container",
    "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV017",
    "Query": "data.appshield.kubernetes.KSV017.deny",
    "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv017",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV022",
    "Title": "Non-default capabilities added",
    "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV022",
    "Query": "data.appshield.kubernetes.KSV022.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv022",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV024",
    "Title": "Access to host ports",
    "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV024",
    "Query": "data.appshield.kubernetes.KSV024.deny",
    "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv024",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV025",
    "Title": "SELinux custom options set",
    "Description": "Setting a custom SELinux user or role option should be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV025",
    "Query": "data.appshield.kubernetes.KSV025.deny",
    "Resolution": "Do not set 'spec.securityContext.seLinuxOptions', spec.containers[*].securityContext.seLinuxOptions and spec.initContainers[*].securityContext.seLinuxOptions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv025",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv025"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV027",
    "Title": "Non-default /proc masks set",
    "Description": "The default /proc masks are set up to reduce attack surface, and should be required.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV027",
    "Query": "data.appshield.kubernetes.KSV027.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.procMount and spec.initContainers[*].securityContext.procMount.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv027",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv027"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV028",
    "Title": "Non-ephemeral volume types used",
    "Description": "In addition to restricting HostPath volumes, usage of non-ephemeral volume types should be limited to those defined through PersistentVolumes.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV028",
    "Query": "data.appshield.kubernetes.KSV028.deny",
    "Resolution": "Do not Set 'spec.volumes[*]' to any of the disallowed volume types.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv028",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv028"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV029",
    "Title": "A root primary or supplementary GID set",
    "Description": "Containers should be forbidden from running with a root primary or supplementary GID.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV029",
    "Query": "data.appshield.kubernetes.KSV029.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv029",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv029"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV030",
    "Title": "Default Seccomp profile not set",
    "Description": "The RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV030",
    "Query": "data.appshield.kubernetes.KSV030.deny",
    "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv030",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv030"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV102",
    "Title": "Tiller Is Deployed",
    "Description": "Check if Helm Tiller component is deployed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV202",
    "Query": "data.appshield.kubernetes.KSV202.deny",
    "Resolution": "Migrate to Helm v3 which no longer has Tiller component",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv102",
    "References": [
     "https://avd.aquasec.com/appshield/ksv102"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "go-testing/configs/Dockerfile.allowed",
  "Class": "config",
  "Type": "dockerfile",
  "Misconfigurations": [
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS002",
    "Title": "root user",
    "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
    "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
    "Namespace": "appshield.dockerfile.DS002",
    "Query": "data.appshield.dockerfile.DS002.deny",
    "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds002",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds002"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS001",
    "Title": "':latest' tag used",
    "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS001",
    "Query": "data.appshield.dockerfile.DS001.deny",
    "Resolution": "Add a tag to the image in the 'FROM' statement",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds001",
    "References": [
     "https://avd.aquasec.com/appshield/ds001"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS004",
    "Title": "Port 22 exposed",
    "Description": "Exposing port 22 might allow users to SSH into the container.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS004",
    "Query": "data.appshield.dockerfile.DS004.deny",
    "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds004",
    "References": [
     "https://avd.aquasec.com/appshield/ds004"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS005",
    "Title": "ADD instead of COPY",
    "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS005",
    "Query": "data.appshield.dockerfile.DS005.deny",
    "Resolution": "Use COPY instead of ADD",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds005",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#add",
     "https://avd.aquasec.com/appshield/ds005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS006",
    "Title": "COPY '--from' referring to the current image",
    "Description": "COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS006",
    "Query": "data.appshield.dockerfile.DS006.deny",
    "Resolution": "Change the '--form' so that it will not refer to itself",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds006",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS007",
    "Title": "Multiple ENTRYPOINT instructions listed",
    "Description": "There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS007",
    "Query": "data.appshield.dockerfile.DS007.deny",
    "Resolution": "Remove unnecessary ENTRYPOINT instruction.",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds007",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#entrypoint",
     "https://avd.aquasec.com/appshield/ds007"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS008",
    "Title": "Exposed port out of range",
    "Description": "UNIX ports outside the range 0-65535 are exposed.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS008",
    "Query": "data.appshield.dockerfile.DS008.deny",
    "Resolution": "Use port number within range",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds008",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#expose",
     "https://avd.aquasec.com/appshield/ds008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS009",
    "Title": "WORKDIR path not absolute",
    "Description": "For clarity and reliability, you should always use absolute paths for your WORKDIR.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS009",
    "Query": "data.appshield.dockerfile.DS009.deny",
    "Resolution": "Use absolute paths for your WORKDIR",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds009",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS010",
    "Title": "RUN using 'sudo'",
    "Description": "Avoid using 'RUN' with 'sudo' commands, as it can lead to unpredictable behavior.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS010",
    "Query": "data.appshield.dockerfile.DS010.deny",
    "Resolution": "Don't use sudo",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds010",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS011",
    "Title": "COPY with more than two arguments not ending with slash",
    "Description": "When a COPY command has more than two arguments, the last one should end with a slash.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS011",
    "Query": "data.appshield.dockerfile.DS011.deny",
    "Resolution": "Add slash to last COPY argument",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds011",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#copy",
     "https://avd.aquasec.com/appshield/ds011"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS012",
    "Title": "Duplicate aliases defined in different FROMs",
    "Description": "Different FROMs can't have the same alias defined.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS012",
    "Query": "data.appshield.dockerfile.DS012.deny",
    "Resolution": "Change aliases to make them different",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds012",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds012"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS013",
    "Title": "'RUN cd ...' to change directory",
    "Description": "Use WORKDIR instead of proliferating instructions like 'RUN cd … \u0026\u0026 do-something', which are hard to read, troubleshoot, and maintain.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS013",
    "Query": "data.appshield.dockerfile.DS013.deny",
    "Resolution": "Use WORKDIR to change directory",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds013",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS014",
    "Title": "RUN using 'wget' and 'curl'",
    "Description": "Avoid using both 'wget' and 'curl' since these tools have the same effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS014",
    "Query": "data.appshield.dockerfile.DS014.deny",
    "Resolution": "Pick one util, either 'wget' or 'curl'",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds014",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds014"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS015",
    "Title": "'yum clean all' missing",
    "Description": "You should use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS015",
    "Query": "data.appshield.dockerfile.DS015.deny",
    "Resolution": "Add 'yum clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds015",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds015"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS016",
    "Title": "Multiple CMD instructions listed",
    "Description": "There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS016",
    "Query": "data.appshield.dockerfile.DS016.deny",
    "Resolution": "Dockefile should only have one CMD instruction. Remove all the other CMD instructions",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds016",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#cmd",
     "https://avd.aquasec.com/appshield/ds016"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS017",
    "Title": "'RUN \u003cpackage-manager\u003e update' instruction alone",
    "Description": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS017",
    "Query": "data.appshield.dockerfile.DS017.deny",
    "Resolution": "Combine '\u003cpackage-manager\u003e update' and '\u003cpackage-manager\u003e install' instructions to single one",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds017",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS018",
    "Title": "'COPY --from' refers to alias not defined previously",
    "Description": "COPY commands with the flag '--from' should mention a previously defined FROM alias.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS018",
    "Query": "data.appshield.dockerfile.DS018.deny",
    "Resolution": "Specify an alias defined previously",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds018",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds018"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS019",
    "Title": "'dnf clean all' missing",
    "Description": "Cached package data should be cleaned after installation to reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS019",
    "Query": "data.appshield.dockerfile.DS019.deny",
    "Resolution": "Add 'dnf clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds019",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds019"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS020",
    "Title": "'zypper clean' missing",
    "Description": "The layer and image size should be reduced by deleting unneeded caches after running zypper.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS020",
    "Query": "data.appshield.dockerfile.DS020.deny",
    "Resolution": "Add 'zypper clean' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds020",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds020"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS021",
    "Title": "'apt-get' missing '-y' to avoid manual input",
    "Description": "'apt-get' calls should use the flag '-y' to avoid manual user input.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS021",
    "Query": "data.appshield.dockerfile.DS021.deny",
    "Resolution": "Add '-y' flag to 'apt-get'",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds021",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds021"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS022",
    "Title": "Deprecated MAINTAINER used",
    "Description": "MAINTAINER has been deprecated since Docker 1.13.0.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS022",
    "Query": "data.appshield.dockerfile.DS022.deny",
    "Resolution": "Use LABEL instead of MAINTAINER",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds022",
    "References": [
     "https://docs.docker.com/engine/deprecated/#maintainer-in-dockerfile",
     "https://avd.aquasec.com/appshield/ds022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS023",
    "Title": "Multiple HEALTHCHECK defined",
    "Description": "Providing more than one HEALTHCHECK instruction per stage is confusing and error-prone.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS023",
    "Query": "data.appshield.dockerfile.DS023.deny",
    "Resolution": "One HEALTHCHECK instruction must remain in Dockerfile. Remove all other instructions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds023",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#healthcheck",
     "https://avd.aquasec.com/appshield/ds023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS024",
    "Title": "'apt-get dist-upgrade' used",
    "Description": "'apt-get dist-upgrade' upgrades a major version so it doesn't make more sense in Dockerfile.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS024",
    "Query": "data.appshield.dockerfile.DS024.deny",
    "Resolution": "Just use different image",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds024",
    "References": [
     "https://avd.aquasec.com/appshield/ds024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "go-testing/configs/Dockerfile.denied",
  "Class": "config",
  "Type": "dockerfile",
  "Misconfigurations": [
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS002",
    "Title": "root user",
    "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
    "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
    "Namespace": "appshield.dockerfile.DS002",
    "Query": "data.appshield.dockerfile.DS002.deny",
    "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds002",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds002"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS001",
    "Title": "':latest' tag used",
    "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS001",
    "Query": "data.appshield.dockerfile.DS001.deny",
    "Resolution": "Add a tag to the image in the 'FROM' statement",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds001",
    "References": [
     "https://avd.aquasec.com/appshield/ds001"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS004",
    "Title": "Port 22 exposed",
    "Description": "Exposing port 22 might allow users to SSH into the container.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS004",
    "Query": "data.appshield.dockerfile.DS004.deny",
    "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds004",
    "References": [
     "https://avd.aquasec.com/appshield/ds004"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS005",
    "Title": "ADD instead of COPY",
    "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS005",
    "Query": "data.appshield.dockerfile.DS005.deny",
    "Resolution": "Use COPY instead of ADD",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds005",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#add",
     "https://avd.aquasec.com/appshield/ds005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS006",
    "Title": "COPY '--from' referring to the current image",
    "Description": "COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS006",
    "Query": "data.appshield.dockerfile.DS006.deny",
    "Resolution": "Change the '--form' so that it will not refer to itself",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds006",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS007",
    "Title": "Multiple ENTRYPOINT instructions listed",
    "Description": "There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS007",
    "Query": "data.appshield.dockerfile.DS007.deny",
    "Resolution": "Remove unnecessary ENTRYPOINT instruction.",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds007",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#entrypoint",
     "https://avd.aquasec.com/appshield/ds007"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS008",
    "Title": "Exposed port out of range",
    "Description": "UNIX ports outside the range 0-65535 are exposed.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS008",
    "Query": "data.appshield.dockerfile.DS008.deny",
    "Resolution": "Use port number within range",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds008",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#expose",
     "https://avd.aquasec.com/appshield/ds008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS009",
    "Title": "WORKDIR path not absolute",
    "Description": "For clarity and reliability, you should always use absolute paths for your WORKDIR.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS009",
    "Query": "data.appshield.dockerfile.DS009.deny",
    "Resolution": "Use absolute paths for your WORKDIR",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds009",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS010",
    "Title": "RUN using 'sudo'",
    "Description": "Avoid using 'RUN' with 'sudo' commands, as it can lead to unpredictable behavior.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS010",
    "Query": "data.appshield.dockerfile.DS010.deny",
    "Resolution": "Don't use sudo",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds010",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS011",
    "Title": "COPY with more than two arguments not ending with slash",
    "Description": "When a COPY command has more than two arguments, the last one should end with a slash.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS011",
    "Query": "data.appshield.dockerfile.DS011.deny",
    "Resolution": "Add slash to last COPY argument",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds011",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#copy",
     "https://avd.aquasec.com/appshield/ds011"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS012",
    "Title": "Duplicate aliases defined in different FROMs",
    "Description": "Different FROMs can't have the same alias defined.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS012",
    "Query": "data.appshield.dockerfile.DS012.deny",
    "Resolution": "Change aliases to make them different",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds012",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds012"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS013",
    "Title": "'RUN cd ...' to change directory",
    "Description": "Use WORKDIR instead of proliferating instructions like 'RUN cd … \u0026\u0026 do-something', which are hard to read, troubleshoot, and maintain.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS013",
    "Query": "data.appshield.dockerfile.DS013.deny",
    "Resolution": "Use WORKDIR to change directory",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds013",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS014",
    "Title": "RUN using 'wget' and 'curl'",
    "Description": "Avoid using both 'wget' and 'curl' since these tools have the same effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS014",
    "Query": "data.appshield.dockerfile.DS014.deny",
    "Resolution": "Pick one util, either 'wget' or 'curl'",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds014",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds014"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS015",
    "Title": "'yum clean all' missing",
    "Description": "You should use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS015",
    "Query": "data.appshield.dockerfile.DS015.deny",
    "Resolution": "Add 'yum clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds015",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds015"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS016",
    "Title": "Multiple CMD instructions listed",
    "Description": "There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS016",
    "Query": "data.appshield.dockerfile.DS016.deny",
    "Resolution": "Dockefile should only have one CMD instruction. Remove all the other CMD instructions",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds016",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#cmd",
     "https://avd.aquasec.com/appshield/ds016"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS017",
    "Title": "'RUN \u003cpackage-manager\u003e update' instruction alone",
    "Description": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS017",
    "Query": "data.appshield.dockerfile.DS017.deny",
    "Resolution": "Combine '\u003cpackage-manager\u003e update' and '\u003cpackage-manager\u003e install' instructions to single one",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds017",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS018",
    "Title": "'COPY --from' refers to alias not defined previously",
    "Description": "COPY commands with the flag '--from' should mention a previously defined FROM alias.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS018",
    "Query": "data.appshield.dockerfile.DS018.deny",
    "Resolution": "Specify an alias defined previously",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds018",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds018"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS019",
    "Title": "'dnf clean all' missing",
    "Description": "Cached package data should be cleaned after installation to reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS019",
    "Query": "data.appshield.dockerfile.DS019.deny",
    "Resolution": "Add 'dnf clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds019",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds019"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS020",
    "Title": "'zypper clean' missing",
    "Description": "The layer and image size should be reduced by deleting unneeded caches after running zypper.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS020",
    "Query": "data.appshield.dockerfile.DS020.deny",
    "Resolution": "Add 'zypper clean' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds020",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds020"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS021",
    "Title": "'apt-get' missing '-y' to avoid manual input",
    "Description": "'apt-get' calls should use the flag '-y' to avoid manual user input.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS021",
    "Query": "data.appshield.dockerfile.DS021.deny",
    "Resolution": "Add '-y' flag to 'apt-get'",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds021",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds021"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS022",
    "Title": "Deprecated MAINTAINER used",
    "Description": "MAINTAINER has been deprecated since Docker 1.13.0.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS022",
    "Query": "data.appshield.dockerfile.DS022.deny",
    "Resolution": "Use LABEL instead of MAINTAINER",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds022",
    "References": [
     "https://docs.docker.com/engine/deprecated/#maintainer-in-dockerfile",
     "https://avd.aquasec.com/appshield/ds022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS023",
    "Title": "Multiple HEALTHCHECK defined",
    "Description": "Providing more than one HEALTHCHECK instruction per stage is confusing and error-prone.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS023",
    "Query": "data.appshield.dockerfile.DS023.deny",
    "Resolution": "One HEALTHCHECK instruction must remain in Dockerfile. Remove all other instructions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds023",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#healthcheck",
     "https://avd.aquasec.com/appshield/ds023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS024",
    "Title": "'apt-get dist-upgrade' used",
    "Description": "'apt-get dist-upgrade' upgrades a major version so it doesn't make more sense in Dockerfile.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS024",
    "Query": "data.appshield.dockerfile.DS024.deny",
    "Resolution": "Just use different image",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds024",
    "References": [
     "https://avd.aquasec.com/appshield/ds024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "mixed/configs/Dockerfile",
  "Class": "config",
  "Type": "dockerfile",
  "Misconfigurations": [
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS002",
    "Title": "root user",
    "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
    "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
    "Namespace": "appshield.dockerfile.DS002",
    "Query": "data.appshield.dockerfile.DS002.deny",
    "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds002",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds002"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS005",
    "Title": "ADD instead of COPY",
    "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
    "Message": "Consider using 'COPY dummy.txt .' command instead of 'ADD dummy.txt .'",
    "Namespace": "appshield.dockerfile.DS005",
    "Query": "data.appshield.dockerfile.DS005.deny",
    "Resolution": "Use COPY instead of ADD",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds005",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#add",
     "https://avd.aquasec.com/appshield/ds005"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS001",
    "Title": "':latest' tag used",
    "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS001",
    "Query": "data.appshield.dockerfile.DS001.deny",
    "Resolution": "Add a tag to the image in the 'FROM' statement",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds001",
    "References": [
     "https://avd.aquasec.com/appshield/ds001"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS004",
    "Title": "Port 22 exposed",
    "Description": "Exposing port 22 might allow users to SSH into the container.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS004",
    "Query": "data.appshield.dockerfile.DS004.deny",
    "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds004",
    "References": [
     "https://avd.aquasec.com/appshield/ds004"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS006",
    "Title": "COPY '--from' referring to the current image",
    "Description": "COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS006",
    "Query": "data.appshield.dockerfile.DS006.deny",
    "Resolution": "Change the '--form' so that it will not refer to itself",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds006",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS007",
    "Title": "Multiple ENTRYPOINT instructions listed",
    "Description": "There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS007",
    "Query": "data.appshield.dockerfile.DS007.deny",
    "Resolution": "Remove unnecessary ENTRYPOINT instruction.",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds007",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#entrypoint",
     "https://avd.aquasec.com/appshield/ds007"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS008",
    "Title": "Exposed port out of range",
    "Description": "UNIX ports outside the range 0-65535 are exposed.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS008",
    "Query": "data.appshield.dockerfile.DS008.deny",
    "Resolution": "Use port number within range",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds008",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#expose",
     "https://avd.aquasec.com/appshield/ds008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS009",
    "Title": "WORKDIR path not absolute",
    "Description": "For clarity and reliability, you should always use absolute paths for your WORKDIR.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS009",
    "Query": "data.appshield.dockerfile.DS009.deny",
    "Resolution": "Use absolute paths for your WORKDIR",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds009",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS010",
    "Title": "RUN using 'sudo'",
    "Description": "Avoid using 'RUN' with 'sudo' commands, as it can lead to unpredictable behavior.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS010",
    "Query": "data.appshield.dockerfile.DS010.deny",
    "Resolution": "Don't use sudo",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds010",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS011",
    "Title": "COPY with more than two arguments not ending with slash",
    "Description": "When a COPY command has more than two arguments, the last one should end with a slash.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS011",
    "Query": "data.appshield.dockerfile.DS011.deny",
    "Resolution": "Add slash to last COPY argument",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds011",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#copy",
     "https://avd.aquasec.com/appshield/ds011"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS012",
    "Title": "Duplicate aliases defined in different FROMs",
    "Description": "Different FROMs can't have the same alias defined.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS012",
    "Query": "data.appshield.dockerfile.DS012.deny",
    "Resolution": "Change aliases to make them different",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds012",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds012"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS013",
    "Title": "'RUN cd ...' to change directory",
    "Description": "Use WORKDIR instead of proliferating instructions like 'RUN cd … \u0026\u0026 do-something', which are hard to read, troubleshoot, and maintain.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS013",
    "Query": "data.appshield.dockerfile.DS013.deny",
    "Resolution": "Use WORKDIR to change directory",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds013",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS014",
    "Title": "RUN using 'wget' and 'curl'",
    "Description": "Avoid using both 'wget' and 'curl' since these tools have the same effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS014",
    "Query": "data.appshield.dockerfile.DS014.deny",
    "Resolution": "Pick one util, either 'wget' or 'curl'",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds014",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds014"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS015",
    "Title": "'yum clean all' missing",
    "Description": "You should use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS015",
    "Query": "data.appshield.dockerfile.DS015.deny",
    "Resolution": "Add 'yum clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds015",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds015"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS016",
    "Title": "Multiple CMD instructions listed",
    "Description": "There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS016",
    "Query": "data.appshield.dockerfile.DS016.deny",
    "Resolution": "Dockefile should only have one CMD instruction. Remove all the other CMD instructions",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds016",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#cmd",
     "https://avd.aquasec.com/appshield/ds016"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS017",
    "Title": "'RUN \u003cpackage-manager\u003e update' instruction alone",
    "Description": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS017",
    "Query": "data.appshield.dockerfile.DS017.deny",
    "Resolution": "Combine '\u003cpackage-manager\u003e update' and '\u003cpackage-manager\u003e install' instructions to single one",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds017",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS018",
    "Title": "'COPY --from' refers to alias not defined previously",
    "Description": "COPY commands with the flag '--from' should mention a previously defined FROM alias.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS018",
    "Query": "data.appshield.dockerfile.DS018.deny",
    "Resolution": "Specify an alias defined previously",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds018",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds018"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS019",
    "Title": "'dnf clean all' missing",
    "Description": "Cached package data should be cleaned after installation to reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS019",
    "Query": "data.appshield.dockerfile.DS019.deny",
    "Resolution": "Add 'dnf clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds019",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds019"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS020",
    "Title": "'zypper clean' missing",
    "Description": "The layer and image size should be reduced by deleting unneeded caches after running zypper.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS020",
    "Query": "data.appshield.dockerfile.DS020.deny",
    "Resolution": "Add 'zypper clean' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds020",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds020"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS021",
    "Title": "'apt-get' missing '-y' to avoid manual input",
    "Description": "'apt-get' calls should use the flag '-y' to avoid manual user input.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS021",
    "Query": "data.appshield.dockerfile.DS021.deny",
    "Resolution": "Add '-y' flag to 'apt-get'",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds021",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds021"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS022",
    "Title": "Deprecated MAINTAINER used",
    "Description": "MAINTAINER has been deprecated since Docker 1.13.0.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS022",
    "Query": "data.appshield.dockerfile.DS022.deny",
    "Resolution": "Use LABEL instead of MAINTAINER",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds022",
    "References": [
     "https://docs.docker.com/engine/deprecated/#maintainer-in-dockerfile",
     "https://avd.aquasec.com/appshield/ds022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS023",
    "Title": "Multiple HEALTHCHECK defined",
    "Description": "Providing more than one HEALTHCHECK instruction per stage is confusing and error-prone.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS023",
    "Query": "data.appshield.dockerfile.DS023.deny",
    "Resolution": "One HEALTHCHECK instruction must remain in Dockerfile. Remove all other instructions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds023",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#healthcheck",
     "https://avd.aquasec.com/appshield/ds023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS024",
    "Title": "'apt-get dist-upgrade' used",
    "Description": "'apt-get dist-upgrade' upgrades a major version so it doesn't make more sense in Dockerfile.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS024",
    "Query": "data.appshield.dockerfile.DS024.deny",
    "Resolution": "Just use different image",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds024",
    "References": [
     "https://avd.aquasec.com/appshield/ds024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "mixed/configs/bucket.yaml",
  "Class": "config",
  "Type": "cloudformation",
  "Misconfigurations": [
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0086",
    "Title": "S3 Access block should block public ACL",
    "Description": "PUT calls with public ACLs specified can make objects public",
    "Message": "Public access block does not block public ACLs",
    "Resolution": "Enable blocking any PUT calls with a public ACL specified",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 18,
     "EndLine": 18
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0087",
    "Title": "S3 Access block should block public policy",
    "Description": "Users could put a policy that allows public access",
    "Message": "Public access block does not block public policies",
    "Resolution": "Prevent policies that allow public access being PUT",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 19,
     "EndLine": 19
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0088",
    "Title": "Unencrypted S3 bucket.",
    "Description": "The bucket objects could be read if compromised",
    "Message": "Bucket does not have encryption enabled",
    "Resolution": "Configure bucket encryption",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 24,
     "EndLine": 24
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0089",
    "Title": "S3 Bucket does not have logging enabled.",
    "Description": "There is no way to determine the access to this bucket",
    "Message": "Bucket does not have logging enabled",
    "Resolution": "Add a logging block to the resource to enable access logging",
    "Severity": "MEDIUM",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 12,
     "EndLine": 24
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0090",
    "Title": "S3 Data should be versioned",
    "Description": "Deleted or modified data would not be recoverable",
    "Message": "Bucket does not have versioning enabled",
    "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
    "Severity": "MEDIUM",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 12,
     "EndLine": 24
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0093",
    "Title": "S3 Access block should restrict public bucket to limit access",
    "Description": "Public buckets can be accessed by anyone",
    "Message": "Public access block does not restrict public buckets",
    "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 21,
     "EndLine": 21
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0132",
    "Title": "S3 encryption should use Customer Managed Keys",
    "Description": "Using AWS managed keys does not allow for fine grained control",
    "Message": "Bucket does not encrypt data with a customer managed key.",
    "Resolution": "Enable encryption using customer managed keys",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 12,
     "EndLine": 24
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0091",
    "Title": "S3 Access Block should Ignore Public Acl",
    "Description": "PUT calls with public ACLs specified can make objects public",
    "Message": "Resource 'S3Bucket' passed check: S3 Access Block should Ignore Public Acl",
    "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 12,
     "EndLine": 24
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0092",
    "Title": "S3 Buckets not publicly accessible through ACL.",
    "Description": "Public access to the bucket can lead to data leakage",
    "Message": "Resource 'S3Bucket' passed check: S3 Buckets not publicly accessible through ACL.",
    "Resolution": "Don't use canned ACLs or switch to private acl",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 12,
     "EndLine": 24
    }
   },
   {
    "Type": "Cloudformation Security Check",
    "ID": "AVD-AWS-0094",
    "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
    "Description": "Public access policies may be applied to sensitive data buckets",
    "Message": "Resource 'S3Bucket' passed check: S3 buckets should each define an aws_s3_bucket_public_access_block",
    "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
    "Severity": "LOW",
    "References": [
     "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "S3Bucket",
     "Provider": "AWS",
     "Service": "s3",
     "StartLine": 12,
     "EndLine": 24
    }
   }
  ]
 },
 {
  "Target": "mixed/configs/deployment.yaml",
  "Class": "config",
  "Type": "kubernetes",
  "Misconfigurations": [
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV001",
    "Title": "Process can elevate its own privileges",
    "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'securityContext.allowPrivilegeEscalation' to false",
    "Namespace": "appshield.kubernetes.KSV001",
    "Query": "data.appshield.kubernetes.KSV001.deny",
    "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv001",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv001"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV003",
    "Title": "Default capabilities not dropped",
    "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should add 'ALL' to 'securityContext.capabilities.drop'",
    "Namespace": "appshield.kubernetes.KSV003",
    "Query": "data.appshield.kubernetes.KSV003.deny",
    "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv003",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
     "https://avd.aquasec.com/appshield/ksv003"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV006",
    "Title": "hostPath volume mounted with docker.sock",
    "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
    "Message": "Deployment 'hello-kubernetes' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'",
    "Namespace": "appshield.kubernetes.KSV006",
    "Query": "data.appshield.kubernetes.KSV006.deny",
    "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv006",
    "References": [
     "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
     "https://avd.aquasec.com/appshield/ksv006"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV011",
    "Title": "CPU not limited",
    "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'resources.limits.cpu'",
    "Namespace": "appshield.kubernetes.KSV011",
    "Query": "data.appshield.kubernetes.KSV011.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv011",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv011"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV012",
    "Title": "Runs as root user",
    "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'securityContext.runAsNonRoot' to true",
    "Namespace": "appshield.kubernetes.KSV012",
    "Query": "data.appshield.kubernetes.KSV012.deny",
    "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv012",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv012"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV014",
    "Title": "Root file system is not read-only",
    "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'securityContext.readOnlyRootFilesystem' to true",
    "Namespace": "appshield.kubernetes.KSV014",
    "Query": "data.appshield.kubernetes.KSV014.deny",
    "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv014",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
     "https://avd.aquasec.com/appshield/ksv014"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV015",
    "Title": "CPU requests not specified",
    "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'resources.requests.cpu'",
    "Namespace": "appshield.kubernetes.KSV015",
    "Query": "data.appshield.kubernetes.KSV015.deny",
    "Resolution": "Set 'containers[].resources.requests.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv015",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv015"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV016",
    "Title": "Memory requests not specified",
    "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'resources.requests.memory'",
    "Namespace": "appshield.kubernetes.KSV016",
    "Query": "data.appshield.kubernetes.KSV016.deny",
    "Resolution": "Set 'containers[].resources.requests.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv016",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv016"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV018",
    "Title": "Memory not limited",
    "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'resources.limits.memory'",
    "Namespace": "appshield.kubernetes.KSV018",
    "Query": "data.appshield.kubernetes.KSV018.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv018",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv018"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV020",
    "Title": "Runs with low user ID",
    "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'securityContext.runAsUser' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV020",
    "Query": "data.appshield.kubernetes.KSV020.deny",
    "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv020",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv020"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV021",
    "Title": "Runs with low group ID",
    "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'hello-kubernetes' should set 'securityContext.runAsGroup' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV021",
    "Query": "data.appshield.kubernetes.KSV021.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv021",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv021"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV023",
    "Title": "hostPath volumes mounted",
    "Description": "HostPath volumes must be forbidden.",
    "Message": "Deployment 'hello-kubernetes' should not set 'spec.template.volumes.hostPath'",
    "Namespace": "appshield.kubernetes.KSV023",
    "Query": "data.appshield.kubernetes.KSV023.deny",
    "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv023",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv023"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV026",
    "Title": "Unsafe sysctl options set",
    "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.",
    "Message": "Deployment 'hello-kubernetes' should set 'securityContext.sysctl' to the allowed values",
    "Namespace": "appshield.kubernetes.KSV026",
    "Query": "data.appshield.kubernetes.KSV026.deny",
    "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset, {\"kernel.shm_rmid_forced\", \"net.ipv4.ip_local_port_range\", \"net.ipv4.ping_group_range\", \"net.ipv4.tcp_syncookies\"}",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv026",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv026"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV002",
    "Title": "Default AppArmor profile not set",
    "Description": "A program inside the container can bypass AppArmor protection policies.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV002",
    "Query": "data.appshield.kubernetes.KSV002.deny",
    "Resolution": "Remove 'container.apparmor.security.beta.kubernetes.io' annotation or set it to 'runtime/default'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv002",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv002"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV005",
    "Title": "SYS_ADMIN capability added",
    "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV005",
    "Query": "data.appshield.kubernetes.KSV005.deny",
    "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv005",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
     "https://avd.aquasec.com/appshield/ksv005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV008",
    "Title": "Access to host IPC namespace",
    "Description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV008",
    "Query": "data.appshield.kubernetes.KSV008.deny",
    "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv008",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV009",
    "Title": "Access to host network",
    "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV009",
    "Query": "data.appshield.kubernetes.KSV009.deny",
    "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv009",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV010",
    "Title": "Access to host PID",
    "Description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV010",
    "Query": "data.appshield.kubernetes.KSV010.deny",
    "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv010",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV013",
    "Title": "Image tag ':latest' used",
    "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV013",
    "Query": "data.appshield.kubernetes.KSV013.deny",
    "Resolution": "Use a specific container image tag that is not 'latest'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv013",
    "References": [
     "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
     "https://avd.aquasec.com/appshield/ksv013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV017",
    "Title": "Privileged container",
    "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV017",
    "Query": "data.appshield.kubernetes.KSV017.deny",
    "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv017",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV022",
    "Title": "Non-default capabilities added",
    "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV022",
    "Query": "data.appshield.kubernetes.KSV022.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv022",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV024",
    "Title": "Access to host ports",
    "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV024",
    "Query": "data.appshield.kubernetes.KSV024.deny",
    "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv024",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV025",
    "Title": "SELinux custom options set",
    "Description": "Setting a custom SELinux user or role option should be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV025",
    "Query": "data.appshield.kubernetes.KSV025.deny",
    "Resolution": "Do not set 'spec.securityContext.seLinuxOptions', spec.containers[*].securityContext.seLinuxOptions and spec.initContainers[*].securityContext.seLinuxOptions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv025",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv025"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV027",
    "Title": "Non-default /proc masks set",
    "Description": "The default /proc masks are set up to reduce attack surface, and should be required.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV027",
    "Query": "data.appshield.kubernetes.KSV027.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.procMount and spec.initContainers[*].securityContext.procMount.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv027",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv027"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV028",
    "Title": "Non-ephemeral volume types used",
    "Description": "In addition to restricting HostPath volumes, usage of non-ephemeral volume types should be limited to those defined through PersistentVolumes.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV028",
    "Query": "data.appshield.kubernetes.KSV028.deny",
    "Resolution": "Do not Set 'spec.volumes[*]' to any of the disallowed volume types.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv028",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv028"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV029",
    "Title": "A root primary or supplementary GID set",
    "Description": "Containers should be forbidden from running with a root primary or supplementary GID.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV029",
    "Query": "data.appshield.kubernetes.KSV029.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv029",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv029"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV030",
    "Title": "Default Seccomp profile not set",
    "Description": "The RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV030",
    "Query": "data.appshield.kubernetes.KSV030.deny",
    "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv030",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv030"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV102",
    "Title": "Tiller Is Deployed",
    "Description": "Check if Helm Tiller component is deployed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV202",
    "Query": "data.appshield.kubernetes.KSV202.deny",
    "Resolution": "Migrate to Helm v3 which no longer has Tiller component",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv102",
    "References": [
     "https://avd.aquasec.com/appshield/ksv102"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "mixed/configs/main.tf",
  "Class": "config",
  "Type": "terraform",
  "Misconfigurations": [
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0005",
    "Title": "API Gateway domain name uses outdated SSL/TLS protocols.",
    "Description": "Outdated SSL policies increase exposure to known vulnerabilities",
    "Message": "Domain name is configured with an outdated TLS policy.",
    "Resolution": "Use the most modern TLS/SSL policies available",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_api_gateway_domain_name.outdated_security_policy",
     "Provider": "AWS",
     "Service": "api-gateway",
     "StartLine": 30,
     "EndLine": 30
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0005",
    "Title": "API Gateway domain name uses outdated SSL/TLS protocols.",
    "Description": "Outdated SSL policies increase exposure to known vulnerabilities",
    "Message": "Domain name is configured with an outdated TLS policy.",
    "Resolution": "Use the most modern TLS/SSL policies available",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_api_gateway_domain_name.empty_security_policy",
     "Provider": "AWS",
     "Service": "api-gateway",
     "StartLine": 26,
     "EndLine": 26
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0005",
    "Title": "API Gateway domain name uses outdated SSL/TLS protocols.",
    "Description": "Outdated SSL policies increase exposure to known vulnerabilities",
    "Message": "Domain name is configured with an outdated TLS policy.",
    "Resolution": "Use the most modern TLS/SSL policies available",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_api_gateway_domain_name.missing_security_policy",
     "Provider": "AWS",
     "Service": "api-gateway",
     "StartLine": 22,
     "EndLine": 23
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0054",
    "Title": "Use of plain HTTP.",
    "Description": "Your traffic is not protected",
    "Message": "Listener for application load balancer does not use HTTPS.",
    "Resolution": "Switch to HTTPS to benefit from TLS security features",
    "Severity": "CRITICAL",
    "References": [
     "https://www.cloudflare.com/en-gb/learning/ssl/why-is-http-not-secure/"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_alb_listener.my-alb-listener",
     "Provider": "AWS",
     "Service": "elb",
     "StartLine": 9,
     "EndLine": 9
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0081",
    "Title": "AWS Classic resource usage.",
    "Description": "Classic resources are running in a shared environment with other customers",
    "Message": "Classic resources should not be used.",
    "Resolution": "Switch to VPC resources",
    "Severity": "CRITICAL",
    "References": [
     "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_db_security_group.my-group",
     "Provider": "AWS",
     "Service": "rds",
     "StartLine": 12,
     "EndLine": 14
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0107",
    "Title": "An ingress security group rule allows traffic from /0.",
    "Description": "Your port exposed to the internet",
    "Message": "Security group rule allows ingress from public internet.",
    "Resolution": "Set a more restrictive cidr range",
    "Severity": "CRITICAL",
    "References": [
     "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_security_group_rule.my-rule",
     "Provider": "AWS",
     "Service": "vpc",
     "StartLine": 4,
     "EndLine": 4
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0124",
    "Title": "Missing description for security group rule.",
    "Description": "Descriptions provide context for the firewall rule reasons",
    "Message": "Security group rule does not have a description.",
    "Resolution": "Add descriptions for all security groups rules",
    "Severity": "LOW",
    "References": [
     "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_security_group_rule.my-rule",
     "Provider": "AWS",
     "Service": "vpc",
     "StartLine": 2,
     "EndLine": 5
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AZU-0038",
    "Title": "Enable disk encryption on managed disk",
    "Description": "Data could be read if compromised",
    "Message": "Managed disk is not encrypted.",
    "Resolution": "Enable encryption on managed disks",
    "Severity": "HIGH",
    "References": [
     "https://docs.microsoft.com/en-us/azure/virtual-machines/linux/disk-encryption"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "azurerm_managed_disk.source",
     "Provider": "Azure",
     "Service": "compute",
     "StartLine": 18,
     "EndLine": 18
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0005",
    "Title": "API Gateway domain name uses outdated SSL/TLS protocols.",
    "Description": "Outdated SSL policies increase exposure to known vulnerabilities",
    "Message": "No issues found",
    "Resolution": "Use the most modern TLS/SSL policies available",
    "Severity": "HIGH",
    "References": [
     "https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_api_gateway_domain_name.valid_security_policy",
     "Provider": "AWS",
     "Service": "api-gateway",
     "StartLine": 33,
     "EndLine": 35
    }
   },
   {
    "Type": "Terraform Security Check",
    "ID": "AVD-AWS-0047",
    "Title": "An outdated SSL policy is in use by a load balancer.",
    "Description": "The SSL policy is outdated and has known vulnerabilities",
    "Message": "No issues found",
    "Resolution": "Use a more recent TLS/SSL policy for the load balancer",
    "Severity": "CRITICAL",
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {
     "Resource": "aws_alb_listener.my-alb-listener",
     "Provider": "AWS",
     "Service": "elb",
     "StartLine": 7,
     "EndLine": 10
    }
   }
  ]
 },
 {
  "Target": "namespace-exception/configs/Dockerfile",
  "Class": "config",
  "Type": "dockerfile",
  "Misconfigurations": [
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS002",
    "Title": "root user",
    "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
    "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
    "Namespace": "appshield.dockerfile.DS002",
    "Query": "data.appshield.dockerfile.DS002.deny",
    "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds002",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds002"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS005",
    "Title": "ADD instead of COPY",
    "Description": "You should use COPY instead of ADD unless you want to extract a tar file. Note that an ADD command will extract a tar file, which adds the risk of Zip-based vulnerabilities. Accordingly, it is advised to use a COPY command, which does not extract tar files.",
    "Message": "Consider using 'COPY dummy.txt .' command instead of 'ADD dummy.txt .'",
    "Namespace": "appshield.dockerfile.DS005",
    "Query": "data.appshield.dockerfile.DS005.deny",
    "Resolution": "Use COPY instead of ADD",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds005",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#add",
     "https://avd.aquasec.com/appshield/ds005"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS001",
    "Title": "':latest' tag used",
    "Description": "When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS001",
    "Query": "data.appshield.dockerfile.DS001.deny",
    "Resolution": "Add a tag to the image in the 'FROM' statement",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds001",
    "References": [
     "https://avd.aquasec.com/appshield/ds001"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS004",
    "Title": "Port 22 exposed",
    "Description": "Exposing port 22 might allow users to SSH into the container.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS004",
    "Query": "data.appshield.dockerfile.DS004.deny",
    "Resolution": "Remove 'EXPOSE 22' statement from the Dockerfile",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds004",
    "References": [
     "https://avd.aquasec.com/appshield/ds004"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS006",
    "Title": "COPY '--from' referring to the current image",
    "Description": "COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS006",
    "Query": "data.appshield.dockerfile.DS006.deny",
    "Resolution": "Change the '--form' so that it will not refer to itself",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds006",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds006"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS007",
    "Title": "Multiple ENTRYPOINT instructions listed",
    "Description": "There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS007",
    "Query": "data.appshield.dockerfile.DS007.deny",
    "Resolution": "Remove unnecessary ENTRYPOINT instruction.",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds007",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#entrypoint",
     "https://avd.aquasec.com/appshield/ds007"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS008",
    "Title": "Exposed port out of range",
    "Description": "UNIX ports outside the range 0-65535 are exposed.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS008",
    "Query": "data.appshield.dockerfile.DS008.deny",
    "Resolution": "Use port number within range",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds008",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#expose",
     "https://avd.aquasec.com/appshield/ds008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS009",
    "Title": "WORKDIR path not absolute",
    "Description": "For clarity and reliability, you should always use absolute paths for your WORKDIR.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS009",
    "Query": "data.appshield.dockerfile.DS009.deny",
    "Resolution": "Use absolute paths for your WORKDIR",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds009",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS010",
    "Title": "RUN using 'sudo'",
    "Description": "Avoid using 'RUN' with 'sudo' commands, as it can lead to unpredictable behavior.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS010",
    "Query": "data.appshield.dockerfile.DS010.deny",
    "Resolution": "Don't use sudo",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds010",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS011",
    "Title": "COPY with more than two arguments not ending with slash",
    "Description": "When a COPY command has more than two arguments, the last one should end with a slash.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS011",
    "Query": "data.appshield.dockerfile.DS011.deny",
    "Resolution": "Add slash to last COPY argument",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds011",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#copy",
     "https://avd.aquasec.com/appshield/ds011"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS012",
    "Title": "Duplicate aliases defined in different FROMs",
    "Description": "Different FROMs can't have the same alias defined.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS012",
    "Query": "data.appshield.dockerfile.DS012.deny",
    "Resolution": "Change aliases to make them different",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds012",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds012"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS013",
    "Title": "'RUN cd ...' to change directory",
    "Description": "Use WORKDIR instead of proliferating instructions like 'RUN cd … \u0026\u0026 do-something', which are hard to read, troubleshoot, and maintain.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS013",
    "Query": "data.appshield.dockerfile.DS013.deny",
    "Resolution": "Use WORKDIR to change directory",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds013",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir",
     "https://avd.aquasec.com/appshield/ds013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS014",
    "Title": "RUN using 'wget' and 'curl'",
    "Description": "Avoid using both 'wget' and 'curl' since these tools have the same effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS014",
    "Query": "data.appshield.dockerfile.DS014.deny",
    "Resolution": "Pick one util, either 'wget' or 'curl'",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds014",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds014"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS015",
    "Title": "'yum clean all' missing",
    "Description": "You should use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS015",
    "Query": "data.appshield.dockerfile.DS015.deny",
    "Resolution": "Add 'yum clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds015",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds015"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS016",
    "Title": "Multiple CMD instructions listed",
    "Description": "There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS016",
    "Query": "data.appshield.dockerfile.DS016.deny",
    "Resolution": "Dockefile should only have one CMD instruction. Remove all the other CMD instructions",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds016",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#cmd",
     "https://avd.aquasec.com/appshield/ds016"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS017",
    "Title": "'RUN \u003cpackage-manager\u003e update' instruction alone",
    "Description": "The instruction 'RUN \u003cpackage-manager\u003e update' should always be followed by '\u003cpackage-manager\u003e install' in the same RUN statement.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS017",
    "Query": "data.appshield.dockerfile.DS017.deny",
    "Resolution": "Combine '\u003cpackage-manager\u003e update' and '\u003cpackage-manager\u003e install' instructions to single one",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds017",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS018",
    "Title": "'COPY --from' refers to alias not defined previously",
    "Description": "COPY commands with the flag '--from' should mention a previously defined FROM alias.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS018",
    "Query": "data.appshield.dockerfile.DS018.deny",
    "Resolution": "Specify an alias defined previously",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds018",
    "References": [
     "https://docs.docker.com/develop/develop-images/multistage-build/",
     "https://avd.aquasec.com/appshield/ds018"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS019",
    "Title": "'dnf clean all' missing",
    "Description": "Cached package data should be cleaned after installation to reduce image size.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS019",
    "Query": "data.appshield.dockerfile.DS019.deny",
    "Resolution": "Add 'dnf clean all' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds019",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
     "https://avd.aquasec.com/appshield/ds019"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS020",
    "Title": "'zypper clean' missing",
    "Description": "The layer and image size should be reduced by deleting unneeded caches after running zypper.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS020",
    "Query": "data.appshield.dockerfile.DS020.deny",
    "Resolution": "Add 'zypper clean' to Dockerfile",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds020",
    "References": [
     "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run",
     "https://avd.aquasec.com/appshield/ds020"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS021",
    "Title": "'apt-get' missing '-y' to avoid manual input",
    "Description": "'apt-get' calls should use the flag '-y' to avoid manual user input.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS021",
    "Query": "data.appshield.dockerfile.DS021.deny",
    "Resolution": "Add '-y' flag to 'apt-get'",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds021",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#run",
     "https://avd.aquasec.com/appshield/ds021"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS022",
    "Title": "Deprecated MAINTAINER used",
    "Description": "MAINTAINER has been deprecated since Docker 1.13.0.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS022",
    "Query": "data.appshield.dockerfile.DS022.deny",
    "Resolution": "Use LABEL instead of MAINTAINER",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds022",
    "References": [
     "https://docs.docker.com/engine/deprecated/#maintainer-in-dockerfile",
     "https://avd.aquasec.com/appshield/ds022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS023",
    "Title": "Multiple HEALTHCHECK defined",
    "Description": "Providing more than one HEALTHCHECK instruction per stage is confusing and error-prone.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS023",
    "Query": "data.appshield.dockerfile.DS023.deny",
    "Resolution": "One HEALTHCHECK instruction must remain in Dockerfile. Remove all other instructions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds023",
    "References": [
     "https://docs.docker.com/engine/reference/builder/#healthcheck",
     "https://avd.aquasec.com/appshield/ds023"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Dockerfile Security Check",
    "ID": "DS024",
    "Title": "'apt-get dist-upgrade' used",
    "Description": "'apt-get dist-upgrade' upgrades a major version so it doesn't make more sense in Dockerfile.",
    "Message": "No issues found",
    "Namespace": "appshield.dockerfile.DS024",
    "Query": "data.appshield.dockerfile.DS024.deny",
    "Resolution": "Just use different image",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ds024",
    "References": [
     "https://avd.aquasec.com/appshield/ds024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "namespace-exception/configs/deployment.yaml",
  "Class": "config",
  "Type": "kubernetes",
  "Misconfigurations": [
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV001",
    "Title": "Process can elevate its own privileges",
    "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.allowPrivilegeEscalation' to false",
    "Namespace": "appshield.kubernetes.KSV001",
    "Query": "data.appshield.kubernetes.KSV001.deny",
    "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv001",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv001"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV003",
    "Title": "Default capabilities not dropped",
    "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should add 'ALL' to 'securityContext.capabilities.drop'",
    "Namespace": "appshield.kubernetes.KSV003",
    "Query": "data.appshield.kubernetes.KSV003.deny",
    "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv003",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
     "https://avd.aquasec.com/appshield/ksv003"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV006",
    "Title": "hostPath volume mounted with docker.sock",
    "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
    "Message": "Deployment 'test-deny' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'",
    "Namespace": "appshield.kubernetes.KSV006",
    "Query": "data.appshield.kubernetes.KSV006.deny",
    "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv006",
    "References": [
     "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
     "https://avd.aquasec.com/appshield/ksv006"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV011",
    "Title": "CPU not limited",
    "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.limits.cpu'",
    "Namespace": "appshield.kubernetes.KSV011",
    "Query": "data.appshield.kubernetes.KSV011.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv011",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv011"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV012",
    "Title": "Runs as root user",
    "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsNonRoot' to true",
    "Namespace": "appshield.kubernetes.KSV012",
    "Query": "data.appshield.kubernetes.KSV012.deny",
    "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv012",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv012"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV014",
    "Title": "Root file system is not read-only",
    "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.readOnlyRootFilesystem' to true",
    "Namespace": "appshield.kubernetes.KSV014",
    "Query": "data.appshield.kubernetes.KSV014.deny",
    "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv014",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
     "https://avd.aquasec.com/appshield/ksv014"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV015",
    "Title": "CPU requests not specified",
    "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.requests.cpu'",
    "Namespace": "appshield.kubernetes.KSV015",
    "Query": "data.appshield.kubernetes.KSV015.deny",
    "Resolution": "Set 'containers[].resources.requests.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv015",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv015"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV016",
    "Title": "Memory requests not specified",
    "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.requests.memory'",
    "Namespace": "appshield.kubernetes.KSV016",
    "Query": "data.appshield.kubernetes.KSV016.deny",
    "Resolution": "Set 'containers[].resources.requests.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv016",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv016"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV018",
    "Title": "Memory not limited",
    "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.limits.memory'",
    "Namespace": "appshield.kubernetes.KSV018",
    "Query": "data.appshield.kubernetes.KSV018.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv018",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv018"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV020",
    "Title": "Runs with low user ID",
    "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsUser' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV020",
    "Query": "data.appshield.kubernetes.KSV020.deny",
    "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv020",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv020"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV021",
    "Title": "Runs with low group ID",
    "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsGroup' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV021",
    "Query": "data.appshield.kubernetes.KSV021.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv021",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv021"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV023",
    "Title": "hostPath volumes mounted",
    "Description": "HostPath volumes must be forbidden.",
    "Message": "Deployment 'test-deny' should not set 'spec.template.volumes.hostPath'",
    "Namespace": "appshield.kubernetes.KSV023",
    "Query": "data.appshield.kubernetes.KSV023.deny",
    "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv023",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv023"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV026",
    "Title": "Unsafe sysctl options set",
    "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.",
    "Message": "Deployment 'test-deny' should set 'securityContext.sysctl' to the allowed values",
    "Namespace": "appshield.kubernetes.KSV026",
    "Query": "data.appshield.kubernetes.KSV026.deny",
    "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset, {\"kernel.shm_rmid_forced\", \"net.ipv4.ip_local_port_range\", \"net.ipv4.ping_group_range\", \"net.ipv4.tcp_syncookies\"}",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv026",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv026"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV002",
    "Title": "Default AppArmor profile not set",
    "Description": "A program inside the container can bypass AppArmor protection policies.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV002",
    "Query": "data.appshield.kubernetes.KSV002.deny",
    "Resolution": "Remove 'container.apparmor.security.beta.kubernetes.io' annotation or set it to 'runtime/default'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv002",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv002"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV005",
    "Title": "SYS_ADMIN capability added",
    "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV005",
    "Query": "data.appshield.kubernetes.KSV005.deny",
    "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv005",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
     "https://avd.aquasec.com/appshield/ksv005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV008",
    "Title": "Access to host IPC namespace",
    "Description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV008",
    "Query": "data.appshield.kubernetes.KSV008.deny",
    "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv008",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV009",
    "Title": "Access to host network",
    "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV009",
    "Query": "data.appshield.kubernetes.KSV009.deny",
    "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv009",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV010",
    "Title": "Access to host PID",
    "Description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV010",
    "Query": "data.appshield.kubernetes.KSV010.deny",
    "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv010",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV013",
    "Title": "Image tag ':latest' used",
    "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV013",
    "Query": "data.appshield.kubernetes.KSV013.deny",
    "Resolution": "Use a specific container image tag that is not 'latest'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv013",
    "References": [
     "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
     "https://avd.aquasec.com/appshield/ksv013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV017",
    "Title": "Privileged container",
    "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV017",
    "Query": "data.appshield.kubernetes.KSV017.deny",
    "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv017",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV022",
    "Title": "Non-default capabilities added",
    "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV022",
    "Query": "data.appshield.kubernetes.KSV022.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv022",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV024",
    "Title": "Access to host ports",
    "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV024",
    "Query": "data.appshield.kubernetes.KSV024.deny",
    "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv024",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV025",
    "Title": "SELinux custom options set",
    "Description": "Setting a custom SELinux user or role option should be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV025",
    "Query": "data.appshield.kubernetes.KSV025.deny",
    "Resolution": "Do not set 'spec.securityContext.seLinuxOptions', spec.containers[*].securityContext.seLinuxOptions and spec.initContainers[*].securityContext.seLinuxOptions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv025",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv025"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV027",
    "Title": "Non-default /proc masks set",
    "Description": "The default /proc masks are set up to reduce attack surface, and should be required.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV027",
    "Query": "data.appshield.kubernetes.KSV027.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.procMount and spec.initContainers[*].securityContext.procMount.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv027",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv027"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV028",
    "Title": "Non-ephemeral volume types used",
    "Description": "In addition to restricting HostPath volumes, usage of non-ephemeral volume types should be limited to those defined through PersistentVolumes.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV028",
    "Query": "data.appshield.kubernetes.KSV028.deny",
    "Resolution": "Do not Set 'spec.volumes[*]' to any of the disallowed volume types.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv028",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv028"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV029",
    "Title": "A root primary or supplementary GID set",
    "Description": "Containers should be forbidden from running with a root primary or supplementary GID.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV029",
    "Query": "data.appshield.kubernetes.KSV029.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv029",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv029"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV030",
    "Title": "Default Seccomp profile not set",
    "Description": "The RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV030",
    "Query": "data.appshield.kubernetes.KSV030.deny",
    "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv030",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv030"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV102",
    "Title": "Tiller Is Deployed",
    "Description": "Check if Helm Tiller component is deployed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV202",
    "Query": "data.appshield.kubernetes.KSV202.deny",
    "Resolution": "Migrate to Helm v3 which no longer has Tiller component",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv102",
    "References": [
     "https://avd.aquasec.com/appshield/ksv102"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "rule-exception/configs/deployment-allow.yaml",
  "Class": "config",
  "Type": "kubernetes",
  "Misconfigurations": [
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV001",
    "Title": "Process can elevate its own privileges",
    "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'securityContext.allowPrivilegeEscalation' to false",
    "Namespace": "appshield.kubernetes.KSV001",
    "Query": "data.appshield.kubernetes.KSV001.deny",
    "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv001",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv001"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV003",
    "Title": "Default capabilities not dropped",
    "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should add 'ALL' to 'securityContext.capabilities.drop'",
    "Namespace": "appshield.kubernetes.KSV003",
    "Query": "data.appshield.kubernetes.KSV003.deny",
    "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv003",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
     "https://avd.aquasec.com/appshield/ksv003"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV006",
    "Title": "hostPath volume mounted with docker.sock",
    "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
    "Message": "Deployment 'test-allow' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'",
    "Namespace": "appshield.kubernetes.KSV006",
    "Query": "data.appshield.kubernetes.KSV006.deny",
    "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv006",
    "References": [
     "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
     "https://avd.aquasec.com/appshield/ksv006"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV011",
    "Title": "CPU not limited",
    "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'resources.limits.cpu'",
    "Namespace": "appshield.kubernetes.KSV011",
    "Query": "data.appshield.kubernetes.KSV011.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv011",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv011"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV012",
    "Title": "Runs as root user",
    "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'securityContext.runAsNonRoot' to true",
    "Namespace": "appshield.kubernetes.KSV012",
    "Query": "data.appshield.kubernetes.KSV012.deny",
    "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv012",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv012"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV014",
    "Title": "Root file system is not read-only",
    "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'securityContext.readOnlyRootFilesystem' to true",
    "Namespace": "appshield.kubernetes.KSV014",
    "Query": "data.appshield.kubernetes.KSV014.deny",
    "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv014",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
     "https://avd.aquasec.com/appshield/ksv014"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV015",
    "Title": "CPU requests not specified",
    "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'resources.requests.cpu'",
    "Namespace": "appshield.kubernetes.KSV015",
    "Query": "data.appshield.kubernetes.KSV015.deny",
    "Resolution": "Set 'containers[].resources.requests.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv015",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv015"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV016",
    "Title": "Memory requests not specified",
    "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'resources.requests.memory'",
    "Namespace": "appshield.kubernetes.KSV016",
    "Query": "data.appshield.kubernetes.KSV016.deny",
    "Resolution": "Set 'containers[].resources.requests.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv016",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv016"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV018",
    "Title": "Memory not limited",
    "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'resources.limits.memory'",
    "Namespace": "appshield.kubernetes.KSV018",
    "Query": "data.appshield.kubernetes.KSV018.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv018",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv018"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV020",
    "Title": "Runs with low user ID",
    "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'securityContext.runAsUser' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV020",
    "Query": "data.appshield.kubernetes.KSV020.deny",
    "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv020",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv020"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV021",
    "Title": "Runs with low group ID",
    "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-allow' should set 'securityContext.runAsGroup' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV021",
    "Query": "data.appshield.kubernetes.KSV021.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv021",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv021"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV023",
    "Title": "hostPath volumes mounted",
    "Description": "HostPath volumes must be forbidden.",
    "Message": "Deployment 'test-allow' should not set 'spec.template.volumes.hostPath'",
    "Namespace": "appshield.kubernetes.KSV023",
    "Query": "data.appshield.kubernetes.KSV023.deny",
    "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv023",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv023"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV026",
    "Title": "Unsafe sysctl options set",
    "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.",
    "Message": "Deployment 'test-allow' should set 'securityContext.sysctl' to the allowed values",
    "Namespace": "appshield.kubernetes.KSV026",
    "Query": "data.appshield.kubernetes.KSV026.deny",
    "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset, {\"kernel.shm_rmid_forced\", \"net.ipv4.ip_local_port_range\", \"net.ipv4.ping_group_range\", \"net.ipv4.tcp_syncookies\"}",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv026",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv026"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV002",
    "Title": "Default AppArmor profile not set",
    "Description": "A program inside the container can bypass AppArmor protection policies.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV002",
    "Query": "data.appshield.kubernetes.KSV002.deny",
    "Resolution": "Remove 'container.apparmor.security.beta.kubernetes.io' annotation or set it to 'runtime/default'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv002",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv002"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV005",
    "Title": "SYS_ADMIN capability added",
    "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV005",
    "Query": "data.appshield.kubernetes.KSV005.deny",
    "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv005",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
     "https://avd.aquasec.com/appshield/ksv005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV008",
    "Title": "Access to host IPC namespace",
    "Description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV008",
    "Query": "data.appshield.kubernetes.KSV008.deny",
    "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv008",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV009",
    "Title": "Access to host network",
    "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV009",
    "Query": "data.appshield.kubernetes.KSV009.deny",
    "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv009",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV010",
    "Title": "Access to host PID",
    "Description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV010",
    "Query": "data.appshield.kubernetes.KSV010.deny",
    "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv010",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV013",
    "Title": "Image tag ':latest' used",
    "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV013",
    "Query": "data.appshield.kubernetes.KSV013.deny",
    "Resolution": "Use a specific container image tag that is not 'latest'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv013",
    "References": [
     "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
     "https://avd.aquasec.com/appshield/ksv013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV017",
    "Title": "Privileged container",
    "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV017",
    "Query": "data.appshield.kubernetes.KSV017.deny",
    "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv017",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV022",
    "Title": "Non-default capabilities added",
    "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV022",
    "Query": "data.appshield.kubernetes.KSV022.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv022",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV024",
    "Title": "Access to host ports",
    "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV024",
    "Query": "data.appshield.kubernetes.KSV024.deny",
    "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv024",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV025",
    "Title": "SELinux custom options set",
    "Description": "Setting a custom SELinux user or role option should be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV025",
    "Query": "data.appshield.kubernetes.KSV025.deny",
    "Resolution": "Do not set 'spec.securityContext.seLinuxOptions', spec.containers[*].securityContext.seLinuxOptions and spec.initContainers[*].securityContext.seLinuxOptions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv025",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv025"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV027",
    "Title": "Non-default /proc masks set",
    "Description": "The default /proc masks are set up to reduce attack surface, and should be required.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV027",
    "Query": "data.appshield.kubernetes.KSV027.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.procMount and spec.initContainers[*].securityContext.procMount.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv027",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv027"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV028",
    "Title": "Non-ephemeral volume types used",
    "Description": "In addition to restricting HostPath volumes, usage of non-ephemeral volume types should be limited to those defined through PersistentVolumes.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV028",
    "Query": "data.appshield.kubernetes.KSV028.deny",
    "Resolution": "Do not Set 'spec.volumes[*]' to any of the disallowed volume types.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv028",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv028"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV029",
    "Title": "A root primary or supplementary GID set",
    "Description": "Containers should be forbidden from running with a root primary or supplementary GID.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV029",
    "Query": "data.appshield.kubernetes.KSV029.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv029",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv029"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV030",
    "Title": "Default Seccomp profile not set",
    "Description": "The RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV030",
    "Query": "data.appshield.kubernetes.KSV030.deny",
    "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv030",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv030"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV102",
    "Title": "Tiller Is Deployed",
    "Description": "Check if Helm Tiller component is deployed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV202",
    "Query": "data.appshield.kubernetes.KSV202.deny",
    "Resolution": "Migrate to Helm v3 which no longer has Tiller component",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv102",
    "References": [
     "https://avd.aquasec.com/appshield/ksv102"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 },
 {
  "Target": "rule-exception/configs/deployment-deny.yaml",
  "Class": "config",
  "Type": "kubernetes",
  "Misconfigurations": [
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV001",
    "Title": "Process can elevate its own privileges",
    "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.allowPrivilegeEscalation' to false",
    "Namespace": "appshield.kubernetes.KSV001",
    "Query": "data.appshield.kubernetes.KSV001.deny",
    "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv001",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv001"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV003",
    "Title": "Default capabilities not dropped",
    "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should add 'ALL' to 'securityContext.capabilities.drop'",
    "Namespace": "appshield.kubernetes.KSV003",
    "Query": "data.appshield.kubernetes.KSV003.deny",
    "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv003",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
     "https://avd.aquasec.com/appshield/ksv003"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV006",
    "Title": "hostPath volume mounted with docker.sock",
    "Description": "Mounting docker.sock from the host can give the container full root access to the host.",
    "Message": "Deployment 'test-deny' should not specify '/var/run/docker.socker' in 'spec.template.volumes.hostPath.path'",
    "Namespace": "appshield.kubernetes.KSV006",
    "Query": "data.appshield.kubernetes.KSV006.deny",
    "Resolution": "Do not specify /var/run/docker.socket in 'spec.template.volumes.hostPath.path'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv006",
    "References": [
     "https://kubesec.io/basics/spec-volumes-hostpath-path-var-run-docker-sock/",
     "https://avd.aquasec.com/appshield/ksv006"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV011",
    "Title": "CPU not limited",
    "Description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.limits.cpu'",
    "Namespace": "appshield.kubernetes.KSV011",
    "Query": "data.appshield.kubernetes.KSV011.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv011",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv011"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV012",
    "Title": "Runs as root user",
    "Description": "'runAsNonRoot' forces the running image to run as a non-root user to ensure least privileges.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsNonRoot' to true",
    "Namespace": "appshield.kubernetes.KSV012",
    "Query": "data.appshield.kubernetes.KSV012.deny",
    "Resolution": "Set 'containers[].securityContext.runAsNonRoot' to true.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv012",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv012"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV014",
    "Title": "Root file system is not read-only",
    "Description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.readOnlyRootFilesystem' to true",
    "Namespace": "appshield.kubernetes.KSV014",
    "Query": "data.appshield.kubernetes.KSV014.deny",
    "Resolution": "Change 'containers[].securityContext.readOnlyRootFilesystem' to 'true'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv014",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-readonlyrootfilesystem-true/",
     "https://avd.aquasec.com/appshield/ksv014"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV015",
    "Title": "CPU requests not specified",
    "Description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.requests.cpu'",
    "Namespace": "appshield.kubernetes.KSV015",
    "Query": "data.appshield.kubernetes.KSV015.deny",
    "Resolution": "Set 'containers[].resources.requests.cpu'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv015",
    "References": [
     "https://cloud.google.com/blog/products/containers-kubernetes/kubernetes-best-practices-resource-requests-and-limits",
     "https://avd.aquasec.com/appshield/ksv015"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV016",
    "Title": "Memory requests not specified",
    "Description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.requests.memory'",
    "Namespace": "appshield.kubernetes.KSV016",
    "Query": "data.appshield.kubernetes.KSV016.deny",
    "Resolution": "Set 'containers[].resources.requests.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv016",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv016"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV018",
    "Title": "Memory not limited",
    "Description": "Enforcing memory limits prevents DoS via resource exhaustion.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'resources.limits.memory'",
    "Namespace": "appshield.kubernetes.KSV018",
    "Query": "data.appshield.kubernetes.KSV018.deny",
    "Resolution": "Set a limit value under 'containers[].resources.limits.memory'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv018",
    "References": [
     "https://kubesec.io/basics/containers-resources-limits-memory/",
     "https://avd.aquasec.com/appshield/ksv018"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV020",
    "Title": "Runs with low user ID",
    "Description": "Force the container to run with user ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsUser' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV020",
    "Query": "data.appshield.kubernetes.KSV020.deny",
    "Resolution": "Set 'containers[].securityContext.runAsUser' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv020",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv020"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV021",
    "Title": "Runs with low group ID",
    "Description": "Force the container to run with group ID \u003e 10000 to avoid conflicts with the host’s user table.",
    "Message": "Container 'hello-kubernetes' of Deployment 'test-deny' should set 'securityContext.runAsGroup' \u003e 10000",
    "Namespace": "appshield.kubernetes.KSV021",
    "Query": "data.appshield.kubernetes.KSV021.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to an integer \u003e 10000.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv021",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-runasuser/",
     "https://avd.aquasec.com/appshield/ksv021"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV023",
    "Title": "hostPath volumes mounted",
    "Description": "HostPath volumes must be forbidden.",
    "Message": "Deployment 'test-deny' should not set 'spec.template.volumes.hostPath'",
    "Namespace": "appshield.kubernetes.KSV023",
    "Query": "data.appshield.kubernetes.KSV023.deny",
    "Resolution": "Do not set 'spec.volumes[*].hostPath'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv023",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv023"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV026",
    "Title": "Unsafe sysctl options set",
    "Description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the Pod, and it is isolated from other Pods or processes on the same Node.",
    "Message": "Deployment 'test-deny' should set 'securityContext.sysctl' to the allowed values",
    "Namespace": "appshield.kubernetes.KSV026",
    "Query": "data.appshield.kubernetes.KSV026.deny",
    "Resolution": "Do not set 'spec.securityContext.sysctls' or set to values in an allowed subset, {\"kernel.shm_rmid_forced\", \"net.ipv4.ip_local_port_range\", \"net.ipv4.ping_group_range\", \"net.ipv4.tcp_syncookies\"}",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv026",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv026"
    ],
    "Status": "FAIL",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV002",
    "Title": "Default AppArmor profile not set",
    "Description": "A program inside the container can bypass AppArmor protection policies.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV002",
    "Query": "data.appshield.kubernetes.KSV002.deny",
    "Resolution": "Remove 'container.apparmor.security.beta.kubernetes.io' annotation or set it to 'runtime/default'.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv002",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv002"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV005",
    "Title": "SYS_ADMIN capability added",
    "Description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV005",
    "Query": "data.appshield.kubernetes.KSV005.deny",
    "Resolution": "Remove the SYS_ADMIN capability from 'containers[].securityContext.capabilities.add'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv005",
    "References": [
     "https://kubesec.io/basics/containers-securitycontext-capabilities-add-index-sys-admin/",
     "https://avd.aquasec.com/appshield/ksv005"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV008",
    "Title": "Access to host IPC namespace",
    "Description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV008",
    "Query": "data.appshield.kubernetes.KSV008.deny",
    "Resolution": "Do not set 'spec.template.spec.hostIPC' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv008",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv008"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV009",
    "Title": "Access to host network",
    "Description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV009",
    "Query": "data.appshield.kubernetes.KSV009.deny",
    "Resolution": "Do not set 'spec.template.spec.hostNetwork' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv009",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv009"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV010",
    "Title": "Access to host PID",
    "Description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV010",
    "Query": "data.appshield.kubernetes.KSV010.deny",
    "Resolution": "Do not set 'spec.template.spec.hostPID' to true.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv010",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv010"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV013",
    "Title": "Image tag ':latest' used",
    "Description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV013",
    "Query": "data.appshield.kubernetes.KSV013.deny",
    "Resolution": "Use a specific container image tag that is not 'latest'.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv013",
    "References": [
     "https://kubernetes.io/docs/concepts/configuration/overview/#container-images",
     "https://avd.aquasec.com/appshield/ksv013"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV017",
    "Title": "Privileged container",
    "Description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV017",
    "Query": "data.appshield.kubernetes.KSV017.deny",
    "Resolution": "Change 'containers[].securityContext.privileged' to 'false'.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv017",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv017"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV022",
    "Title": "Non-default capabilities added",
    "Description": "Adding NET_RAW or capabilities beyond the default set must be disallowed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV022",
    "Query": "data.appshield.kubernetes.KSV022.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.capabilities.add and spec.initContainers[*].securityContext.capabilities.add",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv022",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv022"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV024",
    "Title": "Access to host ports",
    "Description": "HostPorts should be disallowed, or at minimum restricted to a known list.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV024",
    "Query": "data.appshield.kubernetes.KSV024.deny",
    "Resolution": "Do not set spec.containers[*].ports[*].hostPort and spec.initContainers[*].ports[*].hostPort.",
    "Severity": "HIGH",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv024",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv024"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV025",
    "Title": "SELinux custom options set",
    "Description": "Setting a custom SELinux user or role option should be forbidden.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV025",
    "Query": "data.appshield.kubernetes.KSV025.deny",
    "Resolution": "Do not set 'spec.securityContext.seLinuxOptions', spec.containers[*].securityContext.seLinuxOptions and spec.initContainers[*].securityContext.seLinuxOptions.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv025",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv025"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV027",
    "Title": "Non-default /proc masks set",
    "Description": "The default /proc masks are set up to reduce attack surface, and should be required.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV027",
    "Query": "data.appshield.kubernetes.KSV027.deny",
    "Resolution": "Do not set spec.containers[*].securityContext.procMount and spec.initContainers[*].securityContext.procMount.",
    "Severity": "MEDIUM",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv027",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline",
     "https://avd.aquasec.com/appshield/ksv027"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV028",
    "Title": "Non-ephemeral volume types used",
    "Description": "In addition to restricting HostPath volumes, usage of non-ephemeral volume types should be limited to those defined through PersistentVolumes.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV028",
    "Query": "data.appshield.kubernetes.KSV028.deny",
    "Resolution": "Do not Set 'spec.volumes[*]' to any of the disallowed volume types.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv028",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv028"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV029",
    "Title": "A root primary or supplementary GID set",
    "Description": "Containers should be forbidden from running with a root primary or supplementary GID.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV029",
    "Query": "data.appshield.kubernetes.KSV029.deny",
    "Resolution": "Set 'containers[].securityContext.runAsGroup' to a non-zero integer or leave undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv029",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv029"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV030",
    "Title": "Default Seccomp profile not set",
    "Description": "The RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV030",
    "Query": "data.appshield.kubernetes.KSV030.deny",
    "Resolution": "Set 'spec.securityContext.seccompProfile.type', 'spec.containers[*].securityContext.seccompProfile' and 'spec.initContainers[*].securityContext.seccompProfile' to 'RuntimeDefault' or undefined.",
    "Severity": "LOW",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv030",
    "References": [
     "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
     "https://avd.aquasec.com/appshield/ksv030"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   },
   {
    "Type": "Kubernetes Security Check",
    "ID": "KSV102",
    "Title": "Tiller Is Deployed",
    "Description": "Check if Helm Tiller component is deployed.",
    "Message": "No issues found",
    "Namespace": "appshield.kubernetes.KSV202",
    "Query": "data.appshield.kubernetes.KSV202.deny",
    "Resolution": "Migrate to Helm v3 which no longer has Tiller component",
    "Severity": "CRITICAL",
    "PrimaryURL": "https://avd.aquasec.com/appshield/ksv102",
    "References": [
     "https://avd.aquasec.com/appshield/ksv102"
    ],
    "Status": "PASS",
    "Layer": {
     "DiffID": "sha256:223e5dc830556cdf6a782f1150f64d3542b048ecda5caab83807e78da1799f46"
    },
    "IacMetadata": {}
   }
  ]
 }
]